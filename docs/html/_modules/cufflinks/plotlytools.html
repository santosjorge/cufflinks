
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>cufflinks.plotlytools &#8212; Cufflinks  documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for cufflinks.plotlytools</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">plotly.plotly</span> <span class="k">as</span> <span class="nn">py</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="c1"># from plotly.graph_objs import *</span>
<span class="kn">import</span> <span class="nn">plotly.graph_objs</span> <span class="k">as</span> <span class="nn">go</span>
<span class="kn">import</span> <span class="nn">plotly.figure_factory</span> <span class="k">as</span> <span class="nn">ff</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">defaultdict</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="k">import</span> <span class="n">display</span><span class="p">,</span><span class="n">Image</span>
<span class="kn">from</span> <span class="nn">.exceptions</span> <span class="k">import</span> <span class="n">CufflinksError</span>
<span class="kn">from</span> <span class="nn">.colors</span> <span class="k">import</span> <span class="n">normalize</span><span class="p">,</span><span class="n">get_scales</span><span class="p">,</span><span class="n">colorgen</span><span class="p">,</span><span class="n">to_rgba</span><span class="p">,</span><span class="n">get_colorscale</span>
<span class="kn">from</span> <span class="nn">.utils</span> <span class="k">import</span> <span class="n">check_kwargs</span><span class="p">,</span> <span class="n">deep_update</span><span class="p">,</span> <span class="n">kwargs_from_keyword</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="k">import</span> <span class="n">tools</span> 
<span class="kn">from</span> <span class="nn">.</span> <span class="k">import</span> <span class="n">offline</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="k">import</span> <span class="n">auth</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="k">import</span> <span class="n">ta</span>


<span class="n">__TA_KWARGS</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;min_period&#39;</span><span class="p">,</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="s1">&#39;freq&#39;</span><span class="p">,</span><span class="s1">&#39;how&#39;</span><span class="p">,</span><span class="s1">&#39;rsi_upper&#39;</span><span class="p">,</span><span class="s1">&#39;rsi_lower&#39;</span><span class="p">,</span><span class="s1">&#39;boll_std&#39;</span><span class="p">,</span><span class="s1">&#39;fast_period&#39;</span><span class="p">,</span>
			   <span class="s1">&#39;slow_period&#39;</span><span class="p">,</span><span class="s1">&#39;signal_period&#39;</span><span class="p">,</span><span class="s1">&#39;initial&#39;</span><span class="p">,</span><span class="s1">&#39;af&#39;</span><span class="p">,</span><span class="s1">&#39;open&#39;</span><span class="p">,</span><span class="s1">&#39;high&#39;</span><span class="p">,</span><span class="s1">&#39;low&#39;</span><span class="p">,</span><span class="s1">&#39;close&#39;</span><span class="p">]</span>


<div class="viewcode-block" id="iplot_to_dict"><a class="viewcode-back" href="../../cufflinks.plotlytools.html#cufflinks.plotlytools.iplot_to_dict">[docs]</a><span class="k">def</span> <span class="nf">iplot_to_dict</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
	<span class="n">d</span><span class="o">=</span><span class="n">defaultdict</span><span class="p">(</span><span class="nb">dict</span><span class="p">)</span>
	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
		<span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
			<span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]][</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="n">v</span>
	<span class="k">return</span> <span class="n">d</span> </div>

<div class="viewcode-block" id="dict_to_iplot"><a class="viewcode-back" href="../../cufflinks.plotlytools.html#cufflinks.plotlytools.dict_to_iplot">[docs]</a><span class="k">def</span> <span class="nf">dict_to_iplot</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
	<span class="n">l</span><span class="o">=</span><span class="p">[]</span>
	<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
		<span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
	<span class="k">return</span> <span class="n">go</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></div>


<span class="k">def</span> <span class="nf">_to_iplot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">colors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">colorscale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;scatter&#39;</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span><span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span><span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;dot&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="s1">&#39;12&#39;</span><span class="p">,</span><span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
		<span class="n">width</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">dash</span><span class="o">=</span><span class="s1">&#39;solid&#39;</span><span class="p">,</span><span class="n">sortbars</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">keys</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">bestfit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">bestfit_colors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
		<span class="n">mean</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">mean_colors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">asDates</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">asTimestamp</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Generates a plotly Data object </span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">		colors : list or dict</span>
<span class="sd">			{key:color} to specify the color for each column</span>
<span class="sd">			[colors] to use the colors in the defined order</span>
<span class="sd">		colorscale : str </span>
<span class="sd">			Color scale name</span>
<span class="sd">			Only valid if &#39;colors&#39; is null</span>
<span class="sd">			See cufflinks.colors.scales() for available scales</span>
<span class="sd">		kind : string</span>
<span class="sd">			Kind of chart</span>
<span class="sd">				scatter</span>
<span class="sd">				bar</span>
<span class="sd">		mode : string</span>
<span class="sd">			Plotting mode for scatter trace</span>
<span class="sd">				lines</span>
<span class="sd">				markers</span>
<span class="sd">				lines+markers</span>
<span class="sd">				lines+text</span>
<span class="sd">				markers+text</span>
<span class="sd">				lines+markers+text</span>
<span class="sd">		interpolation : string</span>
<span class="sd">			Positioning of the connecting lines</span>
<span class="sd">				linear</span>
<span class="sd">				spline</span>
<span class="sd">				vhv</span>
<span class="sd">				hvh</span>
<span class="sd">				vh</span>
<span class="sd">				hv	</span>
<span class="sd">		symbol : string</span>
<span class="sd">			The symbol that is drawn on the plot for each marker</span>
<span class="sd">			Valid only when mode includes markers</span>
<span class="sd">				dot</span>
<span class="sd">				cross</span>
<span class="sd">				diamond</span>
<span class="sd">				square</span>
<span class="sd">				triangle-down</span>
<span class="sd">				triangle-left</span>
<span class="sd">				triangle-right</span>
<span class="sd">				triangle-up</span>
<span class="sd">				x</span>
<span class="sd">		size : string or int </span>
<span class="sd">			Size of marker </span>
<span class="sd">			Valid only if marker in mode</span>
<span class="sd">		fill : bool</span>
<span class="sd">			Filled Traces</span>
<span class="sd">		width : int</span>
<span class="sd">			Line width</span>
<span class="sd">		dash : string</span>
<span class="sd">			Drawing style of lines</span>
<span class="sd">				solid</span>
<span class="sd">				dash</span>
<span class="sd">				dashdot</span>
<span class="sd">				dot</span>
<span class="sd">		sortbars : bool</span>
<span class="sd">			Sort bars in descending order</span>
<span class="sd">			* Only valid when kind=&#39;bar&#39;</span>
<span class="sd">		keys : list of columns</span>
<span class="sd">			List of columns to chart.</span>
<span class="sd">			Also can be usded for custom sorting.</span>
<span class="sd">		bestfit : boolean or list</span>
<span class="sd">			If True then a best fit line will be generated for </span>
<span class="sd">			all columns. </span>
<span class="sd">			If list then a best fit line will be generated for </span>
<span class="sd">			each key on the list. </span>
<span class="sd">		bestfit_colors : list or dict</span>
<span class="sd">			{key:color} to specify the color for each column</span>
<span class="sd">			[colors] to use the colors in the defined order</span>
<span class="sd">		asDates : bool</span>
<span class="sd">			If true it forces truncates times from a DatetimeIndex</span>
<span class="sd">		</span>
<span class="sd">	&quot;&quot;&quot;</span> 
	<span class="n">df</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

	<span class="k">if</span> <span class="n">asTimestamp</span><span class="p">:</span>
		<span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
	<span class="k">elif</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;PeriodIndex&#39;</span><span class="p">,</span><span class="s1">&#39;DatetimeIndex&#39;</span><span class="p">):</span>
		<span class="k">if</span> <span class="n">asDates</span><span class="p">:</span>
			<span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">date</span>
		<span class="n">x</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">format</span><span class="p">()</span>
	<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="p">):</span>
		<span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;(</span><span class="si">{0}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">__</span><span class="p">)</span> <span class="k">for</span> <span class="n">__</span> <span class="ow">in</span> <span class="n">_</span><span class="p">]))</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span>
	<span class="n">lines</span><span class="o">=</span><span class="p">{}</span>
	<span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">==</span><span class="n">pd</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">series</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
		<span class="n">df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="n">df</span><span class="o">.</span><span class="n">name</span><span class="p">:</span><span class="n">df</span><span class="p">})</span>

	<span class="k">if</span> <span class="ow">not</span> <span class="n">keys</span><span class="p">:</span>		
		<span class="k">if</span> <span class="s1">&#39;bar&#39;</span> <span class="ow">in</span> <span class="n">kind</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">sortbars</span><span class="p">:</span>
				<span class="n">keys</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">keys</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">keys</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

	<span class="n">colors</span><span class="o">=</span><span class="n">get_colors</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span><span class="n">colorscale</span><span class="p">,</span><span class="n">keys</span><span class="p">)</span>
	<span class="n">dash</span><span class="o">=</span><span class="n">get_items_as_list</span><span class="p">(</span><span class="n">dash</span><span class="p">,</span><span class="n">keys</span><span class="p">,</span><span class="s1">&#39;dash&#39;</span><span class="p">)</span>
	<span class="n">symbol</span><span class="o">=</span><span class="n">get_items_as_list</span><span class="p">(</span><span class="n">symbol</span><span class="p">,</span><span class="n">keys</span><span class="p">,</span><span class="s1">&#39;symbol&#39;</span><span class="p">)</span>
	<span class="n">mode</span><span class="o">=</span><span class="n">get_items_as_list</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span><span class="n">keys</span><span class="p">,</span><span class="s1">&#39;mode&#39;</span><span class="p">)</span>
	<span class="n">interpolation</span><span class="o">=</span><span class="n">get_items_as_list</span><span class="p">(</span><span class="n">interpolation</span><span class="p">,</span><span class="n">keys</span><span class="p">,</span><span class="s1">&#39;interpolation&#39;</span><span class="p">)</span>
	<span class="n">width</span><span class="o">=</span><span class="n">get_items_as_list</span><span class="p">(</span><span class="n">width</span><span class="p">,</span><span class="n">keys</span><span class="p">,</span><span class="s1">&#39;width&#39;</span><span class="p">)</span>
	<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
		<span class="n">lines</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">=</span><span class="p">{}</span>
		<span class="n">lines</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">x</span>
		<span class="n">lines</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;y&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
		<span class="n">lines</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">text</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
			<span class="n">lines</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;text&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">text</span>
		<span class="k">if</span> <span class="s1">&#39;bar&#39;</span> <span class="ow">in</span> <span class="n">kind</span><span class="p">:</span>
			<span class="n">lines</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;marker&quot;</span><span class="p">]</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="n">to_rgba</span><span class="p">(</span><span class="n">colors</span><span class="p">[</span><span class="n">key</span><span class="p">],</span><span class="o">.</span><span class="mi">6</span><span class="p">),</span><span class="s1">&#39;line&#39;</span><span class="p">:{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="n">colors</span><span class="p">[</span><span class="n">key</span><span class="p">],</span><span class="s1">&#39;width&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">}}</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">lines</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;line&quot;</span><span class="p">]</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="n">colors</span><span class="p">[</span><span class="n">key</span><span class="p">],</span><span class="s1">&#39;width&#39;</span><span class="p">:</span><span class="n">width</span><span class="p">[</span><span class="n">key</span><span class="p">],</span><span class="s1">&#39;dash&#39;</span><span class="p">:</span><span class="n">dash</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="s1">&#39;shape&#39;</span><span class="p">:</span><span class="n">interpolation</span><span class="p">[</span><span class="n">key</span><span class="p">]}</span>
			<span class="n">lines</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;mode&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">mode</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
			<span class="k">if</span> <span class="s1">&#39;marker&#39;</span> <span class="ow">in</span> <span class="n">mode</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span>
				<span class="n">lines</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;marker&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Marker</span><span class="p">(</span><span class="n">symbol</span><span class="o">=</span><span class="n">symbol</span><span class="p">[</span><span class="n">key</span><span class="p">],</span><span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">fill</span><span class="p">:</span>
				<span class="n">lines</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;fill&quot;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;tonexty&#39;</span> <span class="k">if</span> <span class="n">kind</span><span class="o">==</span><span class="s1">&#39;area&#39;</span> <span class="k">else</span> <span class="s1">&#39;tozeroy&#39;</span>
				<span class="n">lines</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;fillcolor&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">to_rgba</span><span class="p">(</span><span class="n">colors</span><span class="p">[</span><span class="n">key</span><span class="p">],</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;opacity&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;opacity&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="o">.</span><span class="mi">3</span>		<span class="p">)</span>
	<span class="k">if</span> <span class="s1">&#39;bar&#39;</span> <span class="ow">in</span> <span class="n">kind</span><span class="p">:</span>
		<span class="n">lines_plotly</span><span class="o">=</span><span class="p">[</span><span class="n">go</span><span class="o">.</span><span class="n">Bar</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="n">key</span><span class="p">])</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">]</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="n">lines_plotly</span><span class="o">=</span><span class="p">[</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="n">key</span><span class="p">])</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">]</span>
	<span class="k">for</span> <span class="n">trace</span> <span class="ow">in</span> <span class="n">lines_plotly</span><span class="p">:</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">trace</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span><span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">):</span>
			<span class="n">trace</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">trace</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]))</span>

	<span class="k">if</span> <span class="n">bestfit</span><span class="p">:</span>
		<span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">bestfit</span><span class="p">)</span><span class="o">==</span><span class="nb">list</span><span class="p">:</span>
			<span class="n">keys</span><span class="o">=</span><span class="n">bestfit</span>
		<span class="n">d</span><span class="o">=</span><span class="p">{}</span>
		<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
			<span class="n">bestfit</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">bestfit</span><span class="p">()</span>
			<span class="n">d</span><span class="p">[</span><span class="n">bestfit</span><span class="o">.</span><span class="n">formula</span><span class="p">]</span><span class="o">=</span><span class="n">bestfit</span>
		<span class="n">bestfit_lines</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">to_iplot</span><span class="p">(</span><span class="n">bestfit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">colors</span><span class="o">=</span><span class="n">bestfit_colors</span><span class="p">,</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;scatter&#39;</span><span class="p">,</span><span class="n">asTimestamp</span><span class="o">=</span><span class="n">asTimestamp</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">bestfit_lines</span><span class="p">:</span>
			<span class="n">line</span><span class="p">[</span><span class="s1">&#39;line&#39;</span><span class="p">][</span><span class="s1">&#39;dash&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;dash&#39;</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">bestfit_colors</span><span class="p">:</span>
				<span class="n">line</span><span class="p">[</span><span class="s1">&#39;line&#39;</span><span class="p">][</span><span class="s1">&#39;color&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">to_rgba</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="s1">&#39;line&#39;</span><span class="p">][</span><span class="s1">&#39;color&#39;</span><span class="p">],</span><span class="o">.</span><span class="mi">6</span><span class="p">)</span>
		<span class="n">data</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">lines_plotly</span><span class="p">)</span>
		<span class="n">data</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">bestfit_lines</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">data</span>

	<span class="k">if</span> <span class="n">mean</span><span class="p">:</span>
		<span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span><span class="o">==</span><span class="nb">list</span><span class="p">:</span>
			<span class="n">keys</span><span class="o">=</span><span class="n">mean</span>
		<span class="n">d</span><span class="o">=</span><span class="p">{}</span>
		<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
			<span class="n">mean</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
			<span class="n">d</span><span class="p">[</span><span class="s1">&#39;MEAN(</span><span class="si">{key}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)]</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">mean</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">key</span><span class="p">]),</span><span class="n">index</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
		<span class="n">mean_lines</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">to_iplot</span><span class="p">(</span><span class="n">mean</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">colors</span><span class="o">=</span><span class="n">mean_colors</span><span class="p">,</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;scatter&#39;</span><span class="p">,</span><span class="n">asTimestamp</span><span class="o">=</span><span class="n">asTimestamp</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">mean_lines</span><span class="p">:</span>
			<span class="n">line</span><span class="p">[</span><span class="s1">&#39;line&#39;</span><span class="p">][</span><span class="s1">&#39;dash&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;dash&#39;</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">mean_colors</span><span class="p">:</span>
				<span class="n">line</span><span class="p">[</span><span class="s1">&#39;line&#39;</span><span class="p">][</span><span class="s1">&#39;color&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">to_rgba</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="s1">&#39;line&#39;</span><span class="p">][</span><span class="s1">&#39;color&#39;</span><span class="p">],</span><span class="o">.</span><span class="mi">6</span><span class="p">)</span>
		<span class="n">data</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">lines_plotly</span><span class="p">)</span>
		<span class="n">data</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">mean_lines</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">data</span>
	<span class="k">return</span> <span class="n">go</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">lines_plotly</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">_iplot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;scatter&#39;</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">layout</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">sharing</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">xTitle</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">yTitle</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">zTitle</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">theme</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">colors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">colorscale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
			<span class="n">dash</span><span class="o">=</span><span class="s1">&#39;solid&#39;</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span><span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span><span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;dot&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span><span class="n">barmode</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">sortbars</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">bargap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">bargroupgap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">histnorm</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
			<span class="n">histfunc</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;v&#39;</span><span class="p">,</span><span class="n">boxpoints</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">annotations</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">keys</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">bestfit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
			<span class="n">bestfit_colors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">mean</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">mean_colors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">categories</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">z</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">gridcolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
			<span class="n">zerolinecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">margin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">values</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">secondary_y</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">secondary_y_title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">subplots</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">error_x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
			<span class="n">error_y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">error_type</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span><span class="n">locations</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">lon</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">lat</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">asFrame</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">asDates</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">asFigure</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
			<span class="n">asImage</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">dimensions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">asPlot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">asUrl</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">online</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Returns a plotly chart either as inline chart, image of Figure object</span>

<span class="sd">	Parameters:</span>
<span class="sd">	-----------</span>
<span class="sd">		kind : string</span>
<span class="sd">			Kind of chart</span>
<span class="sd">				scatter</span>
<span class="sd">				bar</span>
<span class="sd">				box</span>
<span class="sd">				spread</span>
<span class="sd">				ratio</span>
<span class="sd">				heatmap</span>
<span class="sd">				surface</span>
<span class="sd">				histogram</span>
<span class="sd">				bubble</span>
<span class="sd">				bubble3d</span>
<span class="sd">				scatter3d	</span>
<span class="sd">				scattergeo</span>
<span class="sd">				ohlc</span>
<span class="sd">				candle</span>
<span class="sd">				pie</span>
<span class="sd">				choroplet	</span>
<span class="sd">		data : Data</span>
<span class="sd">			Plotly Data Object.</span>
<span class="sd">			If not entered then the Data object will be automatically</span>
<span class="sd">			generated from the DataFrame.</span>
<span class="sd">		layout : Layout</span>
<span class="sd">			Plotly layout Object</span>
<span class="sd">			If not entered then the Layout objet will be automatically</span>
<span class="sd">			generated from the DataFrame.</span>
<span class="sd">		filename : string</span>
<span class="sd">			Filename to be saved as in plotly account</span>
<span class="sd">		sharing : string</span>
<span class="sd">			Sets the sharing level permission</span>
<span class="sd">				public - anyone can see this chart</span>
<span class="sd">				private - only you can see this chart</span>
<span class="sd">				secret - only people with the link can see the chart</span>
<span class="sd">		title : string</span>
<span class="sd">			Chart Title				</span>
<span class="sd">		xTitle : string</span>
<span class="sd">			X Axis Title</span>
<span class="sd">		yTitle : string</span>
<span class="sd">			Y Axis Title</span>
<span class="sd">				zTitle : string</span>
<span class="sd">		zTitle : string</span>
<span class="sd">			Z Axis Title</span>
<span class="sd">			Applicable only for 3d charts</span>
<span class="sd">		theme : string</span>
<span class="sd">			Layout Theme</span>
<span class="sd">				solar</span>
<span class="sd">				pearl</span>
<span class="sd">				white		</span>
<span class="sd">			see cufflinks.getThemes() for all </span>
<span class="sd">			available themes</span>
<span class="sd">		colors : dict, list or string</span>
<span class="sd">			{key:color} to specify the color for each column</span>
<span class="sd">			[colors] to use the colors in the defined order</span>
<span class="sd">		colorscale : string</span>
<span class="sd">			Color scale name</span>
<span class="sd">			If the color name is preceded by a minus (-) </span>
<span class="sd">			then the scale is inversed</span>
<span class="sd">			Only valid if &#39;colors&#39; is null</span>
<span class="sd">			See cufflinks.colors.scales() for available scales</span>
<span class="sd">		fill : bool</span>
<span class="sd">			Filled Traces		</span>
<span class="sd">		width : dict, list or string</span>
<span class="sd">				string : applies to all traces</span>
<span class="sd">				list : applies to each trace in the order </span>
<span class="sd">						specified</span>
<span class="sd">				dict: {column:value} for each column in </span>
<span class="sd">						the dataframe</span>
<span class="sd">			Line width	</span>
<span class="sd">		dash : dict, list or string</span>
<span class="sd">				string : applies to all traces</span>
<span class="sd">				list : applies to each trace in the order </span>
<span class="sd">						specified</span>
<span class="sd">				dict: {column:value} for each column in </span>
<span class="sd">						the dataframe</span>
<span class="sd">			Drawing style of lines</span>
<span class="sd">				solid</span>
<span class="sd">				dash</span>
<span class="sd">				dashdot</span>
<span class="sd">				dot</span>
<span class="sd">		mode : dict, list or string</span>
<span class="sd">				string : applies to all traces</span>
<span class="sd">				list : applies to each trace in the order </span>
<span class="sd">						specified</span>
<span class="sd">				dict: {column:value} for each column in </span>
<span class="sd">						the dataframe</span>
<span class="sd">			Plotting mode for scatter trace</span>
<span class="sd">				lines</span>
<span class="sd">				markers</span>
<span class="sd">				lines+markers</span>
<span class="sd">				lines+text</span>
<span class="sd">				markers+text</span>
<span class="sd">				lines+markers+text</span>
<span class="sd">		interpolation : dict, list, or string</span>
<span class="sd">				string : applies to all traces</span>
<span class="sd">				list : applies to each trace in the order </span>
<span class="sd">						specified</span>
<span class="sd">				dict: {column:value} for each column in </span>
<span class="sd">						the dataframe</span>
<span class="sd">			Positioning of the connecting lines</span>
<span class="sd">				linear</span>
<span class="sd">				spline</span>
<span class="sd">				vhv</span>
<span class="sd">				hvh</span>
<span class="sd">				vh</span>
<span class="sd">				hv		</span>
<span class="sd">		symbol : dict, list or string</span>
<span class="sd">				string : applies to all traces</span>
<span class="sd">				list : applies to each trace in the order </span>
<span class="sd">						specified</span>
<span class="sd">				dict: {column:value} for each column in </span>
<span class="sd">						the dataframe</span>
<span class="sd">			The symbol that is drawn on the plot for each marker</span>
<span class="sd">			Valid only when mode includes markers</span>
<span class="sd">				dot</span>
<span class="sd">				cross</span>
<span class="sd">				diamond</span>
<span class="sd">				square</span>
<span class="sd">				triangle-down</span>
<span class="sd">				triangle-left</span>
<span class="sd">				triangle-right</span>
<span class="sd">				triangle-up</span>
<span class="sd">				x</span>
<span class="sd">		size : string or int </span>
<span class="sd">			Size of marker </span>
<span class="sd">			Valid only if marker in mode</span>
<span class="sd">		barmode : string</span>
<span class="sd">			Mode when displaying bars</span>
<span class="sd">				group</span>
<span class="sd">				stack</span>
<span class="sd">				overlay</span>
<span class="sd">			* Only valid when kind=&#39;bar&#39;</span>
<span class="sd">		sortbars : bool</span>
<span class="sd">			Sort bars in descending order</span>
<span class="sd">			* Only valid when kind=&#39;bar&#39;</span>
<span class="sd">		bargap : float</span>
<span class="sd">			Sets the gap between bars</span>
<span class="sd">				[0,1)</span>
<span class="sd">			* Only valid when kind is &#39;histogram&#39; or &#39;bar&#39;</span>
<span class="sd">		bargroupgap : float</span>
<span class="sd">			Set the gap between groups</span>
<span class="sd">				[0,1)</span>
<span class="sd">			* Only valid when kind is &#39;histogram&#39; or &#39;bar&#39;		</span>
<span class="sd">		bins : int or tuple </span>
<span class="sd">			if int:</span>
<span class="sd">				Specifies the number of bins </span>
<span class="sd">			if tuple:</span>
<span class="sd">				(start, end, size)</span>
<span class="sd">				start : starting value</span>
<span class="sd">				end: end value</span>
<span class="sd">				size: bin size</span>
<span class="sd">			* Only valid when kind=&#39;histogram&#39;</span>

<span class="sd">		histnorm : string</span>
<span class="sd">				&#39;&#39; (frequency)</span>
<span class="sd">				percent</span>
<span class="sd">				probability</span>
<span class="sd">				density</span>
<span class="sd">				probability density</span>
<span class="sd">			Sets the type of normalization for an histogram trace. By default</span>
<span class="sd">			the height of each bar displays the frequency of occurrence, i.e., </span>
<span class="sd">			the number of times this value was found in the</span>
<span class="sd">			corresponding bin. If set to &#39;percent&#39;, the height of each bar</span>
<span class="sd">			displays the percentage of total occurrences found within the</span>
<span class="sd">			corresponding bin. If set to &#39;probability&#39;, the height of each bar</span>
<span class="sd">			displays the probability that an event will fall into the</span>
<span class="sd">			corresponding bin. If set to &#39;density&#39;, the height of each bar is</span>
<span class="sd">			equal to the number of occurrences in a bin divided by the size of</span>
<span class="sd">			the bin interval such that summing the area of all bins will yield</span>
<span class="sd">			the total number of occurrences. If set to &#39;probability density&#39;,</span>
<span class="sd">			the height of each bar is equal to the number of probability that an</span>
<span class="sd">			event will fall into the corresponding bin divided by the size of</span>
<span class="sd">			the bin interval such that summing the area of all bins will yield</span>
<span class="sd">			1.</span>
<span class="sd">			* Only valid when kind=&#39;histogram&#39;</span>
<span class="sd">		histfunc : string</span>
<span class="sd">				count</span>
<span class="sd">				sum</span>
<span class="sd">				avg</span>
<span class="sd">				min</span>
<span class="sd">				max</span>
<span class="sd">		   Sets the binning function used for an histogram trace. </span>
<span class="sd">			* Only valid when kind=&#39;histogram&#39;           </span>
<span class="sd">		orientation : string</span>
<span class="sd">				h </span>
<span class="sd">				v</span>
<span class="sd">			Sets the orientation of the bars. If set to &#39;v&#39;, the length of each</span>
<span class="sd"> |          bar will run vertically. If set to &#39;h&#39;, the length of each bar will</span>
<span class="sd"> |          run horizontally</span>
<span class="sd">			* Only valid when kind is &#39;histogram&#39;,&#39;bar&#39; or &#39;box&#39;</span>
<span class="sd">		boxpoints : string</span>
<span class="sd">			Displays data points in a box plot</span>
<span class="sd">				outliers</span>
<span class="sd">				all</span>
<span class="sd">				suspectedoutliers</span>
<span class="sd">				False</span>
<span class="sd">		annotations : dictionary</span>
<span class="sd">			Dictionary of annotations</span>
<span class="sd">			{x_point : text}</span>
<span class="sd">		keys : list of columns</span>
<span class="sd">			List of columns to chart.</span>
<span class="sd">			Also can be usded for custom sorting.</span>
<span class="sd">		bestfit : boolean or list</span>
<span class="sd">			If True then a best fit line will be generated for</span>
<span class="sd">			all columns.</span>
<span class="sd">			If list then a best fit line will be generated for</span>
<span class="sd">			each key on the list.</span>
<span class="sd">		bestfit_colors : list or dict</span>
<span class="sd">			{key:color} to specify the color for each column</span>
<span class="sd">			[colors] to use the colors in the defined order	</span>
<span class="sd">		categories : string</span>
<span class="sd">			Name of the column that contains the categories</span>
<span class="sd">		x : string</span>
<span class="sd">			Name of the column that contains the x axis values		</span>
<span class="sd">		y : string</span>
<span class="sd">			Name of the column that contains the y axis values</span>
<span class="sd">		z : string</span>
<span class="sd">			Name of the column that contains the z axis values					</span>
<span class="sd">		text : string</span>
<span class="sd">			Name of the column that contains the text values	</span>
<span class="sd">		gridcolor : string</span>
<span class="sd">			Grid color	</span>
<span class="sd">		zerolinecolor : string</span>
<span class="sd">			Zero line color</span>
<span class="sd">		margin : dict or tuple</span>
<span class="sd">			Dictionary (l,r,b,t) or</span>
<span class="sd">			Tuple containing the left,</span>
<span class="sd">			right, bottom and top margins</span>
<span class="sd">		labels : string</span>
<span class="sd">			Name of the column that contains the labels.</span>
<span class="sd">			* Only valid when kind=&#39;pie&#39; </span>
<span class="sd">		values : string</span>
<span class="sd">			Name of the column that contains the values.</span>
<span class="sd">			* Only valid when kind=&#39;pie&#39;</span>
<span class="sd">		secondary_y : string or list(string)</span>
<span class="sd">			Name(s) of the column to be charted on the </span>
<span class="sd">			right hand side axis</span>
<span class="sd">		secondary_y_title : string</span>
<span class="sd">			Title of the secondary axis</span>
<span class="sd">		subplots : bool</span>
<span class="sd">			If true then each trace is placed in </span>
<span class="sd">			subplot layout</span>
<span class="sd">		shape : (rows,cols)</span>
<span class="sd">			Tuple indicating the size of rows and columns</span>
<span class="sd">			If omitted then the layout is automatically set</span>
<span class="sd">			* Only valid when subplots=True</span>
<span class="sd">		error_x : int or float or [int or float]</span>
<span class="sd">			error values for the x axis</span>
<span class="sd">		error_y : int or float or [int or float]</span>
<span class="sd">			error values for the y axis</span>
<span class="sd">		error_type : string</span>
<span class="sd">			type of error bars</span>
<span class="sd">				&#39;data&#39; </span>
<span class="sd">				&#39;constant&#39;</span>
<span class="sd">				&#39;percent&#39;</span>
<span class="sd">				&#39;sqrt&#39;</span>
<span class="sd">				&#39;continuous&#39;</span>
<span class="sd">				&#39;continuous_percent&#39;</span>
<span class="sd">		asFrame : bool</span>
<span class="sd">			If true then the data component of Figure will</span>
<span class="sd">			be of Pandas form (Series) otherwise they will </span>
<span class="sd">			be index values</span>
<span class="sd">		asDates : bool</span>
<span class="sd">			If true it truncates times from a DatetimeIndex</span>
<span class="sd">		asFigure : bool</span>
<span class="sd">			If True returns plotly Figure</span>
<span class="sd">		asImage : bool</span>
<span class="sd">			If True it returns an Image (png)</span>
<span class="sd">			In ONLINE mode:</span>
<span class="sd">				Image file is saved in the working directory				</span>
<span class="sd">					Accepts:</span>
<span class="sd">						filename</span>
<span class="sd">						dimensions</span>
<span class="sd">						scale</span>
<span class="sd">						display_image</span>
<span class="sd">			In OFFLINE mode:</span>
<span class="sd">				Image file is downloaded (downloads folder) and a </span>
<span class="sd">				regular plotly chart is displayed in Jupyter</span>
<span class="sd">					Accepts:</span>
<span class="sd">						filename</span>
<span class="sd">						dimensions</span>
<span class="sd">		dimensions : tuple(int,int)</span>
<span class="sd">			Dimensions for image / chart</span>
<span class="sd">				(width,height)		</span>
<span class="sd">		asPlot : bool</span>
<span class="sd">			If True the chart opens in browser</span>
<span class="sd">		asUrl : bool</span>
<span class="sd">			If True the chart url/path is returned. No chart is displayed. </span>
<span class="sd">				If Online : the URL is returned</span>
<span class="sd">				If Offline : the local path is returned</span>
<span class="sd">		online : bool</span>
<span class="sd">			If True then the chart/image is rendered on the server </span>
<span class="sd">			even when running in offline mode. </span>

<span class="sd">		Other Kwargs</span>
<span class="sd">		============</span>
<span class="sd">		Line, Scatter</span>
<span class="sd">			connectgaps : bool</span>
<span class="sd">				If True, empty values are connected </span>
<span class="sd">		Pie charts</span>
<span class="sd">			sort : bool</span>
<span class="sd">				If True it sorts the labels by value</span>
<span class="sd">			pull : float [0-1]</span>
<span class="sd">				Pulls the slices from the centre </span>
<span class="sd">			hole : float [0-1]</span>
<span class="sd">				Sets the size of the inner hole</span>
<span class="sd">			linecolor : string</span>
<span class="sd">				Sets the color for the contour line of the slices</span>
<span class="sd">			linewidth : string</span>
<span class="sd">				Sets the width for the contour line of the slices	</span>
<span class="sd">			textcolor : string</span>
<span class="sd">				Sets the color for the text in the slices</span>
<span class="sd">			textposition : string </span>
<span class="sd">				Sets the position of the legends for each slice</span>
<span class="sd">					outside</span>
<span class="sd">					inner</span>
<span class="sd">			textinfo : string </span>
<span class="sd">				Sets the information to be displayed on </span>
<span class="sd">				the legends </span>
<span class="sd">					label</span>
<span class="sd">					percent</span>
<span class="sd">					value</span>
<span class="sd">					* or ony combination of the above using </span>
<span class="sd">					  &#39;+&#39; between each item</span>
<span class="sd">					  ie &#39;label+percent&#39;</span>

<span class="sd">		Histogram</span>
<span class="sd">			line_color : string</span>
<span class="sd">				specifies the line color of the histogram</span>

<span class="sd">		Heatmap and Surface</span>
<span class="sd">			center_scale : float</span>
<span class="sd">				Centers the colorscale at a specific value</span>
<span class="sd">				Automatically sets the (zmin,zmax) values</span>
<span class="sd">			zmin : float</span>
<span class="sd">				Defines the minimum range for the z values. </span>
<span class="sd">				This affects the range for the colorscale</span>
<span class="sd">			zmax : float</span>
<span class="sd">				Defines the maximum range for the z values. </span>
<span class="sd">				This affects the range for the colorscale</span>

<span class="sd">		Error Bars</span>
<span class="sd">			error_trace : string</span>
<span class="sd">				Name of the column for which error should be </span>
<span class="sd">				plotted. If omitted then errors apply to all </span>
<span class="sd">				traces.</span>
<span class="sd">			error_values_minus : int or float or [int or float]</span>
<span class="sd">				Values corresponding to the span of the error bars </span>
<span class="sd">				below the trace coordinates</span>
<span class="sd">			error_color : string</span>
<span class="sd">				Color for error bars</span>
<span class="sd">			error_thickness : float </span>
<span class="sd">				Sets the line thickness of the error bars</span>
<span class="sd">			error_width :  float</span>
<span class="sd">				Sets the width (in pixels) of the cross-bar at both </span>
<span class="sd">				ends of the error bars</span>
<span class="sd">			error_opacity : float [0,1]</span>
<span class="sd">				Opacity for the error bars</span>

<span class="sd">		Subplots</span>
<span class="sd">			horizontal_spacing : float [0,1]</span>
<span class="sd">				Space between subplot columns.</span>
<span class="sd">			vertical_spacing : float [0,1]</span>
<span class="sd">				Space between subplot rows.</span>
<span class="sd">			subplot_titles : bool</span>
<span class="sd">				If True, chart titles are plotted</span>
<span class="sd">				at the top of each subplot</span>
<span class="sd">			shared_xaxes : bool</span>
<span class="sd">				Assign shared x axes.</span>
<span class="sd">				If True, subplots in the same grid column have one common</span>
<span class="sd">				shared x-axis at the bottom of the grid.</span>
<span class="sd">			shared_yaxes : bool</span>
<span class="sd">				Assign shared y axes.</span>
<span class="sd">				If True, subplots in the same grid row have one common</span>
<span class="sd">				shared y-axis on the left-hand side of the grid.</span>

<span class="sd">		Shapes</span>
<span class="sd">			hline : int, list or dict</span>
<span class="sd">				Draws a horizontal line at the </span>
<span class="sd">				indicated y position(s)</span>
<span class="sd">				Extra parameters can be passed in</span>
<span class="sd">				the form of a dictionary (see shapes)</span>
<span class="sd">			vline : int, list or dict</span>
<span class="sd">				Draws a vertical line at the </span>
<span class="sd">				indicated x position(s)</span>
<span class="sd">				Extra parameters can be passed in</span>
<span class="sd">				the form of a dictionary (see shapes)</span>
<span class="sd">			hpsan : (y0,y1)</span>
<span class="sd">				Draws a horizontal rectangle at the </span>
<span class="sd">				indicated (y0,y1) positions.</span>
<span class="sd">				Extra parameters can be passed in</span>
<span class="sd">				the form of a dictionary (see shapes)</span>
<span class="sd">			vspan : (x0,x1)</span>
<span class="sd">				Draws a vertical rectangle at the </span>
<span class="sd">				indicated (x0,x1) positions.</span>
<span class="sd">				Extra parameters can be passed in</span>
<span class="sd">				the form of a dictionary (see shapes)</span>
<span class="sd">			shapes : dict or list(dict)</span>
<span class="sd">				List of dictionaries with the </span>
<span class="sd">				specifications of a given shape.</span>
<span class="sd">				See help(cufflinks.tools.get_shape)</span>
<span class="sd">				for more information</span>
<span class="sd">		</span>
<span class="sd">		Axis Ranges</span>
<span class="sd">			xrange : [lower_bound,upper_bound]</span>
<span class="sd">				Sets the range for the x axis</span>
<span class="sd">			yrange : [lower_bound,upper_bound]</span>
<span class="sd">				Sets the range for the y axis</span>
<span class="sd">			zrange : [lower_bound,upper_bound]</span>
<span class="sd">				Sets the range for the z axis</span>
<span class="sd">				</span>
<span class="sd">		Explicit Layout Updates</span>
<span class="sd">			layout_update : dict</span>
<span class="sd">				The layout will be modified with all </span>
<span class="sd">				the explicit values stated in the </span>
<span class="sd">				dictionary. </span>
<span class="sd">				It will not apply if layout is passed</span>
<span class="sd">				as parameter.</span>


<span class="sd">		Range Selector</span>
<span class="sd">			rangeselector : dict</span>
<span class="sd">				Defines a rangeselector object</span>
<span class="sd">				see help(cf.tools.get_range_selector) for more information</span>
<span class="sd">				Example:</span>
<span class="sd">					{&#39;steps&#39;:[&#39;1y&#39;,&#39;2 months&#39;,&#39;5 weeks&#39;,&#39;ytd&#39;,&#39;2mtd&#39;],</span>
<span class="sd">					 &#39;axis&#39;:&#39;xaxis1&#39;, &#39;bgcolor&#39; : (&#39;blue&#39;,.3),</span>
<span class="sd">					 &#39;x&#39;: 0.2 , &#39;y&#39; : 0.9}</span>

<span class="sd">		Range Slider</span>
<span class="sd">			rangeslider : bool or dict</span>
<span class="sd">				Defines if a rangeslider is displayed</span>
<span class="sd">				If bool: </span>
<span class="sd">					True : Makes it visible</span>
<span class="sd">				if dict:</span>
<span class="sd">					Rangeslider object</span>
<span class="sd">				Example:</span>
<span class="sd">					{&#39;bgcolor&#39;:(&#39;blue&#39;,.3),&#39;autorange&#39;:True}</span>

<span class="sd">		Annotations</span>
<span class="sd">			fontcolor : str</span>
<span class="sd">				Text color for annotations</span>
<span class="sd">			fontsize : int</span>
<span class="sd">				Text size for annotations</span>
<span class="sd">			textangle : int</span>
<span class="sd">				Textt angle </span>
<span class="sd">			See https://plot.ly/python/reference/#layout-annotations </span>
<span class="sd">			for a complete list of valid parameters.</span>

<span class="sd">		Exports</span>
<span class="sd">			display_image : bool</span>
<span class="sd">				If True then the image if displayed after being saved</span>
<span class="sd">				** only valid if asImage=True</span>
<span class="sd">			scale : integer</span>
<span class="sd">				Increase the resolution of the image by `scale` amount</span>
<span class="sd">				Only valid when asImage=True		</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="c1"># Valid Kwargs</span>
	<span class="n">valid_kwargs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">,</span><span class="s1">&#39;opacity&#39;</span><span class="p">,</span><span class="s1">&#39;column&#39;</span><span class="p">,</span><span class="s1">&#39;columns&#39;</span><span class="p">,</span><span class="s1">&#39;labels&#39;</span><span class="p">,</span><span class="s1">&#39;text&#39;</span><span class="p">,</span><span class="s1">&#39;world_readable&#39;</span><span class="p">,</span><span class="s1">&#39;colorbar&#39;</span><span class="p">]</span>
	<span class="n">TRACE_KWARGS</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;hoverinfo&#39;</span><span class="p">,</span><span class="s1">&#39;connectgaps&#39;</span><span class="p">]</span>
	<span class="n">HEATMAP_SURFACE_KWARGS</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;center_scale&#39;</span><span class="p">,</span><span class="s1">&#39;zmin&#39;</span><span class="p">,</span><span class="s1">&#39;zmax&#39;</span><span class="p">]</span>
	<span class="n">PIE_KWARGS</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;sort&#39;</span><span class="p">,</span><span class="s1">&#39;pull&#39;</span><span class="p">,</span><span class="s1">&#39;hole&#39;</span><span class="p">,</span><span class="s1">&#39;textposition&#39;</span><span class="p">,</span><span class="s1">&#39;textinfo&#39;</span><span class="p">,</span><span class="s1">&#39;linecolor&#39;</span><span class="p">,</span><span class="s1">&#39;linewidth&#39;</span><span class="p">,</span><span class="s1">&#39;textcolor&#39;</span><span class="p">]</span>
	<span class="n">OHLC_KWARGS</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;up_color&#39;</span><span class="p">,</span><span class="s1">&#39;down_color&#39;</span><span class="p">,</span><span class="s1">&#39;open&#39;</span><span class="p">,</span><span class="s1">&#39;high&#39;</span><span class="p">,</span><span class="s1">&#39;low&#39;</span><span class="p">,</span><span class="s1">&#39;close&#39;</span><span class="p">,</span><span class="s1">&#39;volume&#39;</span><span class="p">,</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="s1">&#39;decreasing&#39;</span><span class="p">,</span><span class="s1">&#39;increasing&#39;</span><span class="p">]</span>
	<span class="n">SUBPLOT_KWARGS</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;horizontal_spacing&#39;</span><span class="p">,</span> <span class="s1">&#39;vertical_spacing&#39;</span><span class="p">,</span>
					<span class="s1">&#39;specs&#39;</span><span class="p">,</span> <span class="s1">&#39;insets&#39;</span><span class="p">,</span><span class="s1">&#39;start_cell&#39;</span><span class="p">,</span><span class="s1">&#39;shared_xaxes&#39;</span><span class="p">,</span><span class="s1">&#39;shared_yaxes&#39;</span><span class="p">,</span><span class="s1">&#39;subplot_titles&#39;</span><span class="p">]</span>
	<span class="n">GEO_KWARGS</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;locationmode&#39;</span><span class="p">,</span><span class="s1">&#39;locationsrc&#39;</span><span class="p">,</span><span class="s1">&#39;geo&#39;</span><span class="p">,</span><span class="s1">&#39;lon&#39;</span><span class="p">,</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span>
	<span class="n">ERROR_KWARGS</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;error_trace&#39;</span><span class="p">,</span><span class="s1">&#39;error_values_minus&#39;</span><span class="p">,</span><span class="s1">&#39;error_color&#39;</span><span class="p">,</span><span class="s1">&#39;error_thickness&#39;</span><span class="p">,</span>
					<span class="s1">&#39;error_width&#39;</span><span class="p">,</span><span class="s1">&#39;error_opacity&#39;</span><span class="p">]</span>
	<span class="n">EXPORT_KWARGS</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;display_image&#39;</span><span class="p">,</span><span class="s1">&#39;scale&#39;</span><span class="p">]</span>
	<span class="n">kwargs_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">tools</span><span class="o">.</span><span class="n">__LAYOUT_KWARGS</span><span class="p">,</span><span class="n">TRACE_KWARGS</span><span class="p">,</span>
				   <span class="n">OHLC_KWARGS</span><span class="p">,</span><span class="n">PIE_KWARGS</span><span class="p">,</span><span class="n">HEATMAP_SURFACE_KWARGS</span><span class="p">,</span><span class="n">SUBPLOT_KWARGS</span><span class="p">,</span><span class="n">GEO_KWARGS</span><span class="p">,</span><span class="n">ERROR_KWARGS</span><span class="p">,</span><span class="n">EXPORT_KWARGS</span><span class="p">]</span>
	<span class="p">[</span><span class="n">valid_kwargs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">kwargs_list</span><span class="p">]</span>

	<span class="n">dict_modifiers_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;line&#39;</span><span class="p">]</span>
	<span class="n">dict_modifiers</span><span class="o">=</span><span class="p">{}</span>

	<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">dict_modifiers_keys</span><span class="p">:</span>
		<span class="n">dict_modifiers</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="n">kwargs_from_keyword</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,{},</span><span class="n">k</span><span class="p">,</span><span class="kc">True</span><span class="p">)</span>
	

	<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
		<span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">valid_kwargs</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Invalid keyword : &#39;</span><span class="si">{0}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>

	<span class="c1"># Setting default values</span>
	<span class="k">if</span> <span class="ow">not</span> <span class="n">colors</span><span class="p">:</span>
		<span class="n">colors</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;color&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="n">colors</span>
	<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
		<span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="n">colors</span><span class="p">]</span>
	<span class="n">opacity</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;opacity&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;opacity&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="mf">0.8</span>
	<span class="k">if</span> <span class="ow">not</span> <span class="n">dimensions</span><span class="p">:</span>
		<span class="n">dimensions</span><span class="o">=</span><span class="n">auth</span><span class="o">.</span><span class="n">get_config_file</span><span class="p">()[</span><span class="s1">&#39;dimensions&#39;</span><span class="p">]</span>

	<span class="c1"># Get values from config theme</span>
	<span class="k">if</span> <span class="n">theme</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
		<span class="n">theme</span> <span class="o">=</span> <span class="n">auth</span><span class="o">.</span><span class="n">get_config_file</span><span class="p">()[</span><span class="s1">&#39;theme&#39;</span><span class="p">]</span>
	<span class="n">theme_config</span><span class="o">=</span><span class="n">tools</span><span class="o">.</span><span class="n">getTheme</span><span class="p">(</span><span class="n">theme</span><span class="p">)</span>
	<span class="k">if</span> <span class="n">colorscale</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
		<span class="n">config_colorscale</span><span class="o">=</span><span class="n">auth</span><span class="o">.</span><span class="n">get_config_file</span><span class="p">()[</span><span class="s1">&#39;colorscale&#39;</span><span class="p">]</span>
		<span class="k">if</span> <span class="n">config_colorscale</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;dflt&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">):</span>
			<span class="n">colorscale</span><span class="o">=</span><span class="n">theme_config</span><span class="p">[</span><span class="s1">&#39;colorscale&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;colorscale&#39;</span> <span class="ow">in</span> <span class="n">theme_config</span> <span class="k">else</span> <span class="s1">&#39;original&#39;</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">colorscale</span><span class="o">=</span><span class="n">config_colorscale</span>
	<span class="k">if</span> <span class="n">width</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
		<span class="k">if</span> <span class="n">kind</span> <span class="o">!=</span> <span class="s1">&#39;pie&#39;</span><span class="p">:</span>
			<span class="n">width</span><span class="o">=</span><span class="n">theme_config</span><span class="p">[</span><span class="s1">&#39;linewidth&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;linewidth&#39;</span> <span class="ow">in</span> <span class="n">theme_config</span> <span class="k">else</span> <span class="mi">2</span>
	<span class="k">if</span> <span class="n">margin</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
		<span class="n">margin</span><span class="o">=</span><span class="n">auth</span><span class="o">.</span><span class="n">get_config_file</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;margin&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>


	<span class="c1"># In case column was used instead of keys</span>
	<span class="k">if</span> <span class="s1">&#39;column&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
		<span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;column&#39;</span><span class="p">]]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;column&#39;</span><span class="p">],</span><span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;column&#39;</span><span class="p">]</span>
	<span class="k">if</span> <span class="s1">&#39;columns&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
		<span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;columns&#39;</span><span class="p">]]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;columns&#39;</span><span class="p">],</span><span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;columns&#39;</span><span class="p">]</span>
	<span class="n">kind</span><span class="o">=</span><span class="s1">&#39;line&#39;</span> <span class="k">if</span> <span class="n">kind</span><span class="o">==</span><span class="s1">&#39;lines&#39;</span> <span class="k">else</span> <span class="n">kind</span>

	<span class="c1"># Figure generators</span>
	<span class="k">def</span> <span class="nf">get_marker</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="p">{}):</span>
		<span class="k">if</span> <span class="s1">&#39;line&#39;</span> <span class="ow">in</span> <span class="n">dict_modifiers</span><span class="p">:</span>
			<span class="k">if</span> <span class="s1">&#39;color&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dict_modifiers</span><span class="p">[</span><span class="s1">&#39;line&#39;</span><span class="p">]:</span>
				<span class="k">if</span> <span class="s1">&#39;linecolor&#39;</span> <span class="ow">in</span> <span class="n">tools</span><span class="o">.</span><span class="n">getTheme</span><span class="p">(</span><span class="n">theme</span><span class="o">=</span><span class="n">theme</span><span class="p">):</span>
					<span class="n">linecolor</span><span class="o">=</span><span class="n">normalize</span><span class="p">(</span><span class="n">tools</span><span class="o">.</span><span class="n">getTheme</span><span class="p">(</span><span class="n">theme</span><span class="o">=</span><span class="n">theme</span><span class="p">)[</span><span class="s1">&#39;linecolor&#39;</span><span class="p">])</span>
				<span class="k">else</span><span class="p">:</span> 
					<span class="n">linecolor</span><span class="o">=</span><span class="n">tools</span><span class="o">.</span><span class="n">getLayout</span><span class="p">(</span><span class="n">theme</span><span class="o">=</span><span class="n">theme</span><span class="p">)[</span><span class="s1">&#39;xaxis1&#39;</span><span class="p">][</span><span class="s1">&#39;titlefont&#39;</span><span class="p">][</span><span class="s1">&#39;color&#39;</span><span class="p">]</span>
				<span class="n">dict_modifiers</span><span class="p">[</span><span class="s1">&#39;line&#39;</span><span class="p">][</span><span class="s1">&#39;color&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">linecolor</span>			
			<span class="n">dict_modifiers</span><span class="p">[</span><span class="s1">&#39;line&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">tools</span><span class="o">.</span><span class="n">updateColors</span><span class="p">(</span><span class="n">dict_modifiers</span><span class="p">[</span><span class="s1">&#39;line&#39;</span><span class="p">])</span>
			<span class="n">marker</span><span class="p">[</span><span class="s1">&#39;line&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">deep_update</span><span class="p">(</span><span class="n">marker</span><span class="p">[</span><span class="s1">&#39;line&#39;</span><span class="p">],</span><span class="n">dict_modifiers</span><span class="p">[</span><span class="s1">&#39;line&#39;</span><span class="p">])</span>
		<span class="k">return</span> <span class="n">marker</span>

	<span class="c1"># We assume we are good citizens</span>
	<span class="n">validate</span><span class="o">=</span><span class="kc">True</span>
	

	<span class="k">if</span> <span class="ow">not</span> <span class="n">layout</span><span class="p">:</span>
		<span class="n">l_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">([(</span><span class="n">k</span><span class="p">,</span><span class="n">kwargs</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">tools</span><span class="o">.</span><span class="n">__LAYOUT_KWARGS</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">])</span>
		<span class="k">if</span> <span class="n">annotations</span><span class="p">:</span>
			<span class="n">ann_kwargs</span><span class="o">=</span><span class="n">check_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">tools</span><span class="o">.</span><span class="n">__ANN_KWARGS</span><span class="p">,</span><span class="n">clean_origin</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
			<span class="n">annotations</span><span class="o">=</span><span class="n">tools</span><span class="o">.</span><span class="n">getAnnotations</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span><span class="n">annotations</span><span class="p">,</span><span class="n">kind</span><span class="o">=</span><span class="n">kind</span><span class="p">,</span><span class="n">theme</span><span class="o">=</span><span class="n">theme</span><span class="p">,</span><span class="o">**</span><span class="n">ann_kwargs</span><span class="p">)</span>


		<span class="n">layout</span><span class="o">=</span><span class="n">tools</span><span class="o">.</span><span class="n">getLayout</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="n">kind</span><span class="p">,</span><span class="n">theme</span><span class="o">=</span><span class="n">theme</span><span class="p">,</span><span class="n">xTitle</span><span class="o">=</span><span class="n">xTitle</span><span class="p">,</span><span class="n">yTitle</span><span class="o">=</span><span class="n">yTitle</span><span class="p">,</span><span class="n">zTitle</span><span class="o">=</span><span class="n">zTitle</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span><span class="n">barmode</span><span class="o">=</span><span class="n">barmode</span><span class="p">,</span>
								<span class="n">bargap</span><span class="o">=</span><span class="n">bargap</span><span class="p">,</span><span class="n">bargroupgap</span><span class="o">=</span><span class="n">bargroupgap</span><span class="p">,</span><span class="n">annotations</span><span class="o">=</span><span class="n">annotations</span><span class="p">,</span><span class="n">gridcolor</span><span class="o">=</span><span class="n">gridcolor</span><span class="p">,</span>
							   <span class="n">dimensions</span><span class="o">=</span><span class="n">dimensions</span><span class="p">,</span>
								<span class="n">zerolinecolor</span><span class="o">=</span><span class="n">zerolinecolor</span><span class="p">,</span><span class="n">margin</span><span class="o">=</span><span class="n">margin</span><span class="p">,</span><span class="n">is3d</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span> <span class="ow">in</span> <span class="n">kind</span><span class="p">,</span><span class="o">**</span><span class="n">l_kwargs</span><span class="p">)</span>

	<span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="p">:</span>
		<span class="k">if</span> <span class="n">categories</span><span class="p">:</span>
			<span class="n">data</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Data</span><span class="p">()</span>
			<span class="k">if</span> <span class="s1">&#39;bar&#39;</span> <span class="ow">in</span> <span class="n">kind</span><span class="p">:</span>
				<span class="n">df</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
				<span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">categories</span><span class="p">)</span>
				<span class="n">fig</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="n">kind</span><span class="p">,</span><span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span><span class="n">colorscale</span><span class="o">=</span><span class="n">colorscale</span><span class="p">,</span><span class="n">fill</span><span class="o">=</span><span class="n">fill</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span><span class="n">sortbars</span><span class="o">=</span><span class="n">sortbars</span><span class="p">,</span>
						<span class="n">asDates</span><span class="o">=</span><span class="n">asDates</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span><span class="n">symbol</span><span class="o">=</span><span class="n">symbol</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">,</span><span class="n">barmode</span><span class="o">=</span><span class="n">barmode</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="n">orientation</span><span class="p">)</span>
				<span class="n">data</span><span class="o">=</span><span class="n">fig</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]</span>			
			<span class="k">else</span><span class="p">:</span>
				<span class="n">_keys</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">categories</span><span class="p">])</span>
				<span class="n">colors</span><span class="o">=</span><span class="n">get_colors</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span><span class="n">colorscale</span><span class="p">,</span><span class="n">_keys</span><span class="p">)</span>	
				<span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span> <span class="k">if</span> <span class="s1">&#39;markers&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">mode</span> <span class="k">else</span> <span class="n">mode</span> 
				<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">_keys</span><span class="p">:</span>
					<span class="n">__</span><span class="o">=</span><span class="bp">self</span><span class="p">[</span><span class="bp">self</span><span class="p">[</span><span class="n">categories</span><span class="p">]</span><span class="o">==</span><span class="n">_</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
					<span class="k">if</span> <span class="n">text</span><span class="p">:</span>
						<span class="n">_text</span><span class="o">=</span><span class="n">__</span><span class="p">[</span><span class="n">text</span><span class="p">]</span> <span class="k">if</span> <span class="n">asFrame</span> <span class="k">else</span> <span class="n">__</span><span class="p">[</span><span class="n">text</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
					<span class="n">_x</span><span class="o">=</span><span class="n">__</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">if</span> <span class="n">asFrame</span> <span class="k">else</span> <span class="n">__</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
					<span class="n">_y</span><span class="o">=</span><span class="n">__</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="k">if</span> <span class="n">asFrame</span> <span class="k">else</span> <span class="n">__</span><span class="p">[</span><span class="n">y</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
					<span class="k">if</span> <span class="n">z</span><span class="p">:</span>
						<span class="n">_z</span><span class="o">=</span><span class="n">__</span><span class="p">[</span><span class="n">z</span><span class="p">]</span> <span class="k">if</span> <span class="n">asFrame</span> <span class="k">else</span> <span class="n">__</span><span class="p">[</span><span class="n">z</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
					<span class="k">if</span> <span class="s1">&#39;bubble&#39;</span> <span class="ow">in</span> <span class="n">kind</span><span class="p">:</span>
						<span class="n">rg</span><span class="o">=</span><span class="n">__</span><span class="p">[</span><span class="n">size</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
						<span class="n">rgo</span><span class="o">=</span><span class="bp">self</span><span class="p">[</span><span class="n">size</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
						<span class="n">_size</span><span class="o">=</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-</span><span class="n">rgo</span><span class="o">.</span><span class="n">min</span><span class="p">())</span><span class="o">/</span><span class="p">(</span><span class="n">rgo</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">-</span><span class="n">rgo</span><span class="o">.</span><span class="n">min</span><span class="p">()))</span><span class="o">+</span><span class="mi">12</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">rg</span><span class="p">]</span>		
					<span class="k">else</span><span class="p">:</span>
						<span class="n">_size</span><span class="o">=</span><span class="n">size</span>
					<span class="n">_data</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter3d</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">_x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">_y</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="n">_</span><span class="p">,</span>
								<span class="n">marker</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Marker</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">_</span><span class="p">],</span><span class="n">symbol</span><span class="o">=</span><span class="n">symbol</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">_size</span><span class="p">,</span><span class="n">opacity</span><span class="o">=</span><span class="n">opacity</span><span class="p">,</span>
												<span class="n">line</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Line</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">)),</span><span class="n">textfont</span><span class="o">=</span><span class="n">tools</span><span class="o">.</span><span class="n">getLayout</span><span class="p">(</span><span class="n">theme</span><span class="o">=</span><span class="n">theme</span><span class="p">)[</span><span class="s1">&#39;xaxis1&#39;</span><span class="p">][</span><span class="s1">&#39;titlefont&#39;</span><span class="p">])</span>
					<span class="k">if</span> <span class="s1">&#39;3d&#39;</span> <span class="ow">in</span> <span class="n">kind</span><span class="p">:</span>
						<span class="n">_data</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter3d</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">_x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">_y</span><span class="p">,</span><span class="n">z</span><span class="o">=</span><span class="n">_z</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="n">_</span><span class="p">,</span>
								<span class="n">marker</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Marker</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">_</span><span class="p">],</span><span class="n">symbol</span><span class="o">=</span><span class="n">symbol</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">_size</span><span class="p">,</span><span class="n">opacity</span><span class="o">=</span><span class="n">opacity</span><span class="p">,</span>
												<span class="n">line</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Line</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">)),</span><span class="n">textfont</span><span class="o">=</span><span class="n">tools</span><span class="o">.</span><span class="n">getLayout</span><span class="p">(</span><span class="n">theme</span><span class="o">=</span><span class="n">theme</span><span class="p">)[</span><span class="s1">&#39;xaxis1&#39;</span><span class="p">][</span><span class="s1">&#39;titlefont&#39;</span><span class="p">])</span>
					<span class="k">else</span><span class="p">:</span>
						<span class="n">_data</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">_x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">_y</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="n">_</span><span class="p">,</span>
								<span class="n">marker</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Marker</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">_</span><span class="p">],</span><span class="n">symbol</span><span class="o">=</span><span class="n">symbol</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">_size</span><span class="p">,</span><span class="n">opacity</span><span class="o">=</span><span class="n">opacity</span><span class="p">,</span>
												<span class="n">line</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Line</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">)),</span><span class="n">textfont</span><span class="o">=</span><span class="n">tools</span><span class="o">.</span><span class="n">getLayout</span><span class="p">(</span><span class="n">theme</span><span class="o">=</span><span class="n">theme</span><span class="p">)[</span><span class="s1">&#39;xaxis1&#39;</span><span class="p">][</span><span class="s1">&#39;titlefont&#39;</span><span class="p">])</span>
					<span class="k">if</span> <span class="n">text</span><span class="p">:</span>
						<span class="n">_data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">_text</span><span class="p">)</span>
					<span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_data</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">kind</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;scatter&#39;</span><span class="p">,</span><span class="s1">&#39;spread&#39;</span><span class="p">,</span><span class="s1">&#39;ratio&#39;</span><span class="p">,</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span><span class="s1">&#39;barh&#39;</span><span class="p">,</span><span class="s1">&#39;area&#39;</span><span class="p">,</span><span class="s1">&#39;line&#39;</span><span class="p">):</span>
				<span class="n">df</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
				<span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">==</span><span class="n">pd</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">series</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
					<span class="n">df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="n">df</span><span class="o">.</span><span class="n">name</span><span class="p">:</span><span class="n">df</span><span class="p">})</span>
				<span class="k">if</span> <span class="n">x</span><span class="p">:</span>
					<span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
				<span class="k">if</span> <span class="n">y</span><span class="p">:</span>
					<span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">y</span><span class="p">]</span>
				<span class="k">if</span> <span class="n">kind</span><span class="o">==</span><span class="s1">&#39;area&#39;</span><span class="p">:</span>
					<span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
				<span class="k">if</span> <span class="n">text</span><span class="p">:</span>
					<span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">text</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
						<span class="n">text</span><span class="o">=</span><span class="bp">self</span><span class="p">[</span><span class="n">text</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
				<span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">to_iplot</span><span class="p">(</span><span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span><span class="n">colorscale</span><span class="o">=</span><span class="n">colorscale</span><span class="p">,</span><span class="n">kind</span><span class="o">=</span><span class="n">kind</span><span class="p">,</span><span class="n">interpolation</span><span class="o">=</span><span class="n">interpolation</span><span class="p">,</span><span class="n">fill</span><span class="o">=</span><span class="n">fill</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span><span class="n">dash</span><span class="o">=</span><span class="n">dash</span><span class="p">,</span><span class="n">sortbars</span><span class="o">=</span><span class="n">sortbars</span><span class="p">,</span><span class="n">keys</span><span class="o">=</span><span class="n">keys</span><span class="p">,</span>
						<span class="n">bestfit</span><span class="o">=</span><span class="n">bestfit</span><span class="p">,</span><span class="n">bestfit_colors</span><span class="o">=</span><span class="n">bestfit_colors</span><span class="p">,</span><span class="n">mean</span><span class="o">=</span><span class="n">mean</span><span class="p">,</span><span class="n">mean_colors</span><span class="o">=</span><span class="n">mean_colors</span><span class="p">,</span><span class="n">asDates</span><span class="o">=</span><span class="n">asDates</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span><span class="n">symbol</span><span class="o">=</span><span class="n">symbol</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span>
						<span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>		
				<span class="n">trace_kw</span><span class="o">=</span><span class="n">check_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">TRACE_KWARGS</span><span class="p">)</span>
				<span class="k">for</span> <span class="n">trace</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
					<span class="n">trace</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">**</span><span class="n">trace_kw</span><span class="p">)</span>		
						
				<span class="k">if</span> <span class="n">kind</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;spread&#39;</span><span class="p">,</span><span class="s1">&#39;ratio&#39;</span><span class="p">):</span>
						<span class="k">if</span> <span class="n">kind</span><span class="o">==</span><span class="s1">&#39;spread&#39;</span><span class="p">:</span>
							<span class="n">trace</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
							<span class="n">positive</span><span class="o">=</span><span class="n">trace</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span> <span class="k">if</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">0</span> <span class="k">else</span> <span class="n">pd</span><span class="o">.</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
							<span class="n">negative</span><span class="o">=</span><span class="n">trace</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span> <span class="k">if</span> <span class="n">x</span><span class="o">&lt;</span><span class="mi">0</span> <span class="k">else</span> <span class="n">pd</span><span class="o">.</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
							<span class="n">trace</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;positive&#39;</span><span class="p">:</span><span class="n">positive</span><span class="p">,</span><span class="s1">&#39;negative&#39;</span><span class="p">:</span><span class="n">negative</span><span class="p">})</span>
							<span class="n">trace</span><span class="o">=</span><span class="n">trace</span><span class="o">.</span><span class="n">to_iplot</span><span class="p">(</span><span class="n">colors</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;positive&#39;</span><span class="p">:</span><span class="s1">&#39;green&#39;</span><span class="p">,</span><span class="s1">&#39;negative&#39;</span><span class="p">:</span><span class="s1">&#39;red&#39;</span><span class="p">},</span><span class="n">width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
						<span class="k">else</span><span class="p">:</span>
							<span class="n">trace</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mf">1.0</span><span class="o">/</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">to_iplot</span><span class="p">(</span><span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;green&#39;</span><span class="p">],</span><span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
						<span class="n">trace</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;xaxis&#39;</span><span class="p">:</span><span class="s1">&#39;x2&#39;</span><span class="p">,</span><span class="s1">&#39;yaxis&#39;</span><span class="p">:</span><span class="s1">&#39;y2&#39;</span><span class="p">,</span><span class="s1">&#39;fill&#39;</span><span class="p">:</span><span class="s1">&#39;tozeroy&#39;</span><span class="p">,</span>
										<span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="n">kind</span><span class="o">.</span><span class="n">capitalize</span><span class="p">(),</span><span class="s1">&#39;connectgaps&#39;</span><span class="p">:</span><span class="kc">False</span><span class="p">,</span><span class="s1">&#39;showlegend&#39;</span><span class="p">:</span><span class="kc">False</span><span class="p">})</span>
						<span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">trace</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
						<span class="k">if</span> <span class="n">kind</span><span class="o">==</span><span class="s1">&#39;spread&#39;</span><span class="p">:</span>
							<span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">trace</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
						<span class="n">layout</span><span class="p">[</span><span class="s1">&#39;yaxis1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;domain&#39;</span><span class="p">:[</span><span class="o">.</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">]})</span>
						<span class="n">layout</span><span class="p">[</span><span class="s1">&#39;yaxis2&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">layout</span><span class="p">[</span><span class="s1">&#39;yaxis1&#39;</span><span class="p">])</span>
						<span class="n">layout</span><span class="p">[</span><span class="s1">&#39;xaxis2&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">layout</span><span class="p">[</span><span class="s1">&#39;xaxis1&#39;</span><span class="p">])</span>
						<span class="n">layout</span><span class="p">[</span><span class="s1">&#39;yaxis2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">domain</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">.</span><span class="mi">25</span><span class="p">],</span><span class="n">title</span><span class="o">=</span><span class="n">kind</span><span class="o">.</span><span class="n">capitalize</span><span class="p">())</span>
						<span class="n">layout</span><span class="p">[</span><span class="s1">&#39;xaxis2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">anchor</span><span class="o">=</span><span class="s1">&#39;y2&#39;</span><span class="p">,</span><span class="n">showticklabels</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
						<span class="n">layout</span><span class="p">[</span><span class="s1">&#39;hovermode&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;x&#39;</span>
				<span class="k">if</span> <span class="s1">&#39;bar&#39;</span> <span class="ow">in</span> <span class="n">kind</span><span class="p">:</span>
					<span class="k">if</span> <span class="s1">&#39;stack&#39;</span> <span class="ow">in</span> <span class="n">barmode</span><span class="p">:</span>
						<span class="n">layout</span><span class="p">[</span><span class="s1">&#39;legend&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">traceorder</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">)</span>
					<span class="n">orientation</span> <span class="o">=</span> <span class="s1">&#39;h&#39;</span> <span class="k">if</span> <span class="n">kind</span><span class="o">==</span><span class="s1">&#39;barh&#39;</span> <span class="k">else</span> <span class="n">orientation</span>
					<span class="k">for</span> <span class="n">trace</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
						<span class="n">trace</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">orientation</span><span class="o">=</span><span class="n">orientation</span><span class="p">)</span>
						<span class="k">if</span> <span class="n">kind</span><span class="o">==</span><span class="s1">&#39;barh&#39;</span><span class="p">:</span>
							<span class="n">trace</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span><span class="n">trace</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">trace</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span><span class="n">trace</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>	
						
			<span class="k">elif</span> <span class="n">kind</span><span class="o">==</span><span class="s1">&#39;bubble&#39;</span><span class="p">:</span>
				<span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span> <span class="k">if</span> <span class="s1">&#39;markers&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">mode</span> <span class="k">else</span> <span class="n">mode</span> 
				<span class="n">x</span><span class="o">=</span><span class="bp">self</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
				<span class="n">y</span><span class="o">=</span><span class="bp">self</span><span class="p">[</span><span class="n">y</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
				<span class="n">z</span><span class="o">=</span><span class="n">size</span> <span class="k">if</span> <span class="n">size</span> <span class="k">else</span> <span class="n">z</span>
				<span class="n">rg</span><span class="o">=</span><span class="bp">self</span><span class="p">[</span><span class="n">z</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
				<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rg</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
					<span class="n">z</span><span class="o">=</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">_</span><span class="p">)</span><span class="o">-</span><span class="n">rg</span><span class="o">.</span><span class="n">min</span><span class="p">())</span><span class="o">/</span><span class="p">(</span><span class="n">rg</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">-</span><span class="n">rg</span><span class="o">.</span><span class="n">min</span><span class="p">()))</span><span class="o">+</span><span class="mi">12</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">rg</span><span class="p">]</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">z</span><span class="o">=</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rg</span><span class="p">)</span> <span class="k">else</span> <span class="p">[]</span>
				<span class="n">text</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;labels&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="n">text</span>
				<span class="n">labels</span><span class="o">=</span><span class="bp">self</span><span class="p">[</span><span class="n">text</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="k">if</span> <span class="n">text</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
				<span class="n">clrs</span><span class="o">=</span><span class="n">colors</span> <span class="k">if</span> <span class="n">colors</span> <span class="k">else</span> <span class="n">get_scales</span><span class="p">(</span><span class="n">colorscale</span><span class="p">)</span>
				<span class="n">clrs</span><span class="o">=</span><span class="p">[</span><span class="n">clrs</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">clrs</span><span class="p">,</span><span class="nb">list</span><span class="p">)</span> <span class="k">else</span> <span class="n">clrs</span>
				<span class="n">clrs</span><span class="o">=</span><span class="p">[</span><span class="n">clrs</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
				<span class="n">marker</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Marker</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">clrs</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">z</span><span class="p">,</span><span class="n">symbol</span><span class="o">=</span><span class="n">symbol</span><span class="p">,</span>
								<span class="n">line</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Line</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">))</span>
				<span class="n">trace</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
				<span class="n">data</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Data</span><span class="p">([</span><span class="n">trace</span><span class="p">])</span>
			<span class="k">elif</span> <span class="n">kind</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;box&#39;</span><span class="p">,</span><span class="s1">&#39;histogram&#39;</span><span class="p">,</span><span class="s1">&#39;hist&#39;</span><span class="p">,</span><span class="s1">&#39;violin&#39;</span><span class="p">):</span>
				<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">pd</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">series</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
					<span class="n">df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">:</span><span class="bp">self</span><span class="p">})</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">df</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
				<span class="n">data</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Data</span><span class="p">()</span>
				<span class="n">clrs</span><span class="o">=</span><span class="n">get_colors</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span><span class="n">colorscale</span><span class="p">,</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
				<span class="k">if</span> <span class="s1">&#39;hist&#39;</span> <span class="ow">in</span> <span class="n">kind</span><span class="p">:</span>
					<span class="n">barmode</span> <span class="o">=</span> <span class="s1">&#39;overlay&#39;</span> <span class="k">if</span> <span class="n">barmode</span><span class="o">==</span><span class="s1">&#39;&#39;</span> <span class="k">else</span>	 <span class="n">barmode</span> 
					<span class="n">layout</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">barmode</span><span class="o">=</span><span class="n">barmode</span><span class="p">)</span> 
				<span class="n">columns</span><span class="o">=</span><span class="n">keys</span> <span class="k">if</span> <span class="n">keys</span> <span class="k">else</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span>
				<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
					<span class="k">if</span> <span class="n">kind</span><span class="o">==</span><span class="s1">&#39;box&#39;</span><span class="p">:</span>
						<span class="n">__</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">_</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span><span class="n">marker</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Marker</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">clrs</span><span class="p">[</span><span class="n">_</span><span class="p">]),</span><span class="n">name</span><span class="o">=</span><span class="n">_</span><span class="p">,</span>
								<span class="n">line</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Line</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">),</span><span class="n">boxpoints</span><span class="o">=</span><span class="n">boxpoints</span><span class="p">)</span>
					<span class="k">elif</span> <span class="n">kind</span><span class="o">==</span><span class="s1">&#39;violin&#39;</span><span class="p">:</span>
						<span class="n">figure</span> <span class="o">=</span> <span class="n">ff</span><span class="o">.</span><span class="n">create_violin</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">melt</span><span class="p">(),</span> <span class="n">data_header</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">group_header</span><span class="o">=</span><span class="s1">&#39;variable&#39;</span><span class="p">,</span>
							<span class="n">theme</span><span class="o">=</span><span class="n">theme</span><span class="p">,</span><span class="n">xTitle</span><span class="o">=</span><span class="n">xTitle</span><span class="p">,</span><span class="n">yTitle</span><span class="o">=</span><span class="n">yTitle</span><span class="p">,</span><span class="n">zTitle</span><span class="o">=</span><span class="n">zTitle</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">)</span>
						<span class="k">if</span> <span class="n">asFigure</span><span class="p">:</span>
							<span class="k">return</span> <span class="n">figure</span>
						<span class="k">else</span><span class="p">:</span>
							<span class="k">return</span> <span class="n">iplot</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span><span class="n">validate</span><span class="o">=</span><span class="n">validate</span><span class="p">,</span><span class="n">sharing</span><span class="o">=</span><span class="n">sharing</span><span class="p">,</span><span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
								<span class="n">online</span><span class="o">=</span><span class="n">online</span><span class="p">,</span><span class="n">asImage</span><span class="o">=</span><span class="n">asImage</span><span class="p">,</span><span class="n">asUrl</span><span class="o">=</span><span class="n">asUrl</span><span class="p">,</span><span class="n">asPlot</span><span class="o">=</span><span class="n">asPlot</span><span class="p">,</span>
								<span class="n">dimensions</span><span class="o">=</span><span class="n">dimensions</span><span class="p">,</span><span class="n">display_image</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;display_image&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">))</span>

					<span class="k">else</span><span class="p">:</span>
						<span class="n">__</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Histogram</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">_</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span><span class="n">name</span><span class="o">=</span><span class="n">_</span><span class="p">,</span>
								<span class="n">marker</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Marker</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">clrs</span><span class="p">[</span><span class="n">_</span><span class="p">],</span> <span class="n">line</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Line</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">)),</span>
								<span class="n">orientation</span><span class="o">=</span><span class="n">orientation</span><span class="p">,</span>
								<span class="n">opacity</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;opacity&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;opacity&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="o">.</span><span class="mi">8</span><span class="p">,</span> <span class="n">histfunc</span><span class="o">=</span><span class="n">histfunc</span><span class="p">,</span>
								<span class="n">histnorm</span><span class="o">=</span><span class="n">histnorm</span><span class="p">)</span>

						<span class="n">__</span><span class="p">[</span><span class="s1">&#39;marker&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">get_marker</span><span class="p">(</span><span class="n">__</span><span class="p">[</span><span class="s1">&#39;marker&#39;</span><span class="p">])</span>

						<span class="k">if</span> <span class="n">orientation</span><span class="o">==</span><span class="s1">&#39;h&#39;</span><span class="p">:</span>
							<span class="n">__</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">__</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
							<span class="k">del</span> <span class="n">__</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
						<span class="k">if</span> <span class="n">bins</span><span class="p">:</span>
							<span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">bins</span><span class="p">)</span> <span class="ow">in</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
								<span class="k">try</span><span class="p">:</span>
									<span class="n">_bins</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;start&#39;</span><span class="p">:</span><span class="n">bins</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;end&#39;</span><span class="p">:</span><span class="n">bins</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="n">bins</span><span class="p">[</span><span class="mi">2</span><span class="p">]}</span>
									<span class="k">if</span> <span class="n">orientation</span><span class="o">==</span><span class="s1">&#39;h&#39;</span><span class="p">:</span>
										<span class="n">__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">ybins</span><span class="o">=</span><span class="n">_bins</span><span class="p">,</span><span class="n">autobiny</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>	
									<span class="k">else</span><span class="p">:</span>
										<span class="n">__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">xbins</span><span class="o">=</span><span class="n">_bins</span><span class="p">,</span><span class="n">autobinx</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>	
								<span class="k">except</span><span class="p">:</span>
									<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Invalid format for bins generation&quot;</span><span class="p">)</span>
							<span class="k">else</span><span class="p">:</span>
								<span class="k">if</span> <span class="n">orientation</span><span class="o">==</span><span class="s1">&#39;h&#39;</span><span class="p">:</span>
									<span class="n">__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">nbinsy</span><span class="o">=</span><span class="n">bins</span><span class="p">)</span>	
								<span class="k">else</span><span class="p">:</span>
									<span class="n">__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">nbinsx</span><span class="o">=</span><span class="n">bins</span><span class="p">)</span>
					<span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">__</span><span class="p">)</span>

			<span class="k">elif</span> <span class="n">kind</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;heatmap&#39;</span><span class="p">,</span><span class="s1">&#39;surface&#39;</span><span class="p">):</span>
				<span class="k">if</span> <span class="n">x</span><span class="p">:</span>
					<span class="n">x</span><span class="o">=</span><span class="bp">self</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;PeriodIndex&#39;</span><span class="p">,</span><span class="s1">&#39;DatetimeIndex&#39;</span><span class="p">):</span>
						<span class="n">x</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">format</span><span class="p">()</span>
					<span class="k">else</span><span class="p">:</span>
						<span class="n">x</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
				<span class="n">y</span><span class="o">=</span><span class="bp">self</span><span class="p">[</span><span class="n">y</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="k">if</span> <span class="n">y</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
				<span class="n">z</span><span class="o">=</span><span class="bp">self</span><span class="p">[</span><span class="n">z</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="k">if</span> <span class="n">z</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
				<span class="n">scale</span><span class="o">=</span><span class="n">get_scales</span><span class="p">(</span><span class="s1">&#39;rdbu&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">colorscale</span> <span class="k">else</span> <span class="n">get_scales</span><span class="p">(</span><span class="n">colorscale</span><span class="p">)</span>
				<span class="n">colorscale</span><span class="o">=</span><span class="p">[[</span><span class="nb">float</span><span class="p">(</span><span class="n">_</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">scale</span><span class="p">[</span><span class="n">_</span><span class="p">]]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">scale</span><span class="p">))]</span>
				<span class="n">center_scale</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;center_scale&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
				<span class="n">zmin</span><span class="o">=</span><span class="n">z</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
				<span class="n">zmax</span><span class="o">=</span><span class="n">z</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
				<span class="k">if</span> <span class="n">center_scale</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
					<span class="k">if</span> <span class="n">center_scale</span><span class="o">&lt;=</span><span class="n">zmin</span><span class="o">+</span><span class="p">(</span><span class="n">zmax</span><span class="o">-</span><span class="n">zmin</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">:</span>
						<span class="n">zmin</span><span class="o">=</span><span class="n">center_scale</span><span class="o">*</span><span class="mi">2</span><span class="o">-</span><span class="n">zmax</span>
					<span class="k">else</span><span class="p">:</span>
						<span class="n">zmax</span><span class="o">=</span><span class="n">center_scale</span><span class="o">*</span><span class="mi">2</span><span class="o">-</span><span class="n">zmin</span>
				<span class="n">zmin</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;zmin&#39;</span><span class="p">,</span><span class="n">zmin</span><span class="p">)</span>
				<span class="n">zmax</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;zmax&#39;</span><span class="p">,</span><span class="n">zmax</span><span class="p">)</span>
				<span class="k">if</span> <span class="n">kind</span><span class="o">==</span><span class="s1">&#39;heatmap&#39;</span><span class="p">:</span>
					<span class="n">data</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Data</span><span class="p">([</span><span class="n">go</span><span class="o">.</span><span class="n">Heatmap</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span><span class="n">zmin</span><span class="o">=</span><span class="n">zmin</span><span class="p">,</span><span class="n">zmax</span><span class="o">=</span><span class="n">zmax</span><span class="p">,</span><span class="n">colorscale</span><span class="o">=</span><span class="n">colorscale</span><span class="p">)])</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">data</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Data</span><span class="p">([</span><span class="n">go</span><span class="o">.</span><span class="n">Surface</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span><span class="n">zmin</span><span class="o">=</span><span class="n">zmin</span><span class="p">,</span><span class="n">zmax</span><span class="o">=</span><span class="n">zmax</span><span class="p">,</span><span class="n">colorscale</span><span class="o">=</span><span class="n">colorscale</span><span class="p">)])</span>

			<span class="k">elif</span> <span class="n">kind</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;scatter3d&#39;</span><span class="p">,</span><span class="s1">&#39;bubble3d&#39;</span><span class="p">):</span>
				<span class="n">data</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Data</span><span class="p">()</span>
				<span class="n">keys</span><span class="o">=</span><span class="bp">self</span><span class="p">[</span><span class="n">text</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="k">if</span> <span class="n">text</span> <span class="k">else</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)))</span>
				<span class="n">colors</span><span class="o">=</span><span class="n">get_colors</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span><span class="n">colorscale</span><span class="p">,</span><span class="n">keys</span><span class="p">,</span><span class="n">asList</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
				<span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span> <span class="k">if</span> <span class="s1">&#39;markers&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">mode</span> <span class="k">else</span> <span class="n">mode</span> 
				<span class="n">df</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
				<span class="n">df</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">keys</span>
				<span class="k">if</span> <span class="n">kind</span><span class="o">==</span><span class="s1">&#39;bubble3d&#39;</span><span class="p">:</span>
					<span class="n">rg</span><span class="o">=</span><span class="bp">self</span><span class="p">[</span><span class="n">size</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
					<span class="n">size</span><span class="o">=</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">_</span><span class="p">)</span><span class="o">-</span><span class="n">rg</span><span class="o">.</span><span class="n">min</span><span class="p">())</span><span class="o">/</span><span class="p">(</span><span class="n">rg</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">-</span><span class="n">rg</span><span class="o">.</span><span class="n">min</span><span class="p">()))</span><span class="o">+</span><span class="mi">12</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">rg</span><span class="p">]</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">size</span><span class="o">=</span><span class="p">[</span><span class="n">size</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">keys</span><span class="p">))]</span>	

				<span class="n">_data</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter3d</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span><span class="n">y</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">y</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span><span class="n">z</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">z</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span><span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="n">keys</span><span class="p">,</span>
									<span class="n">marker</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Marker</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span><span class="n">symbol</span><span class="o">=</span><span class="n">symbol</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span><span class="n">opacity</span><span class="o">=.</span><span class="mi">8</span><span class="p">))</span>
				<span class="k">if</span> <span class="n">text</span><span class="p">:</span>
					<span class="n">_data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">keys</span><span class="p">)</span>
				<span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_data</span><span class="p">)</span>

			<span class="k">elif</span> <span class="n">kind</span><span class="o">==</span><span class="s1">&#39;pie&#39;</span><span class="p">:</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="n">labels</span><span class="p">:</span>
					<span class="k">raise</span> <span class="n">CufflinksError</span><span class="p">(</span><span class="s1">&#39;Missing: labels&#39;</span><span class="p">)</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="n">values</span><span class="p">:</span>
					<span class="k">raise</span> <span class="n">CufflinksError</span><span class="p">(</span><span class="s1">&#39;Missing: values&#39;</span><span class="p">)</span>
				<span class="n">labels</span><span class="o">=</span><span class="bp">self</span><span class="p">[</span><span class="n">labels</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
				<span class="n">values</span><span class="o">=</span><span class="bp">self</span><span class="p">[</span><span class="n">values</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
				<span class="n">marker</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Marker</span><span class="p">(</span><span class="n">colors</span><span class="o">=</span><span class="n">get_colors</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span><span class="n">colorscale</span><span class="p">,</span><span class="n">labels</span><span class="p">,</span><span class="n">asList</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
				<span class="n">marker</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">line</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Line</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;linecolor&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">),</span><span class="n">width</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;linewidth&#39;</span><span class="p">,</span><span class="n">width</span><span class="p">)))</span>
				<span class="n">pie</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Pie</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">values</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">)</span>
				
				<span class="n">kw</span><span class="o">=</span><span class="n">check_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">PIE_KWARGS</span><span class="p">)</span>
				<span class="n">kw</span><span class="p">[</span><span class="s1">&#39;textfont&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="n">kw</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;textcolor&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">)}</span>
				<span class="n">pie</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kw</span><span class="p">)</span>
				<span class="n">data</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Data</span><span class="p">()</span>
				<span class="k">del</span> <span class="n">layout</span><span class="p">[</span><span class="s1">&#39;xaxis1&#39;</span><span class="p">]</span>
				<span class="k">del</span> <span class="n">layout</span><span class="p">[</span><span class="s1">&#39;yaxis1&#39;</span><span class="p">]</span>
				<span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pie</span><span class="p">)</span>
				<span class="n">validate</span><span class="o">=</span><span class="kc">False</span>

			<span class="k">elif</span> <span class="n">kind</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;old_candle&#39;</span><span class="p">,</span><span class="s1">&#39;old_ohlc&#39;</span><span class="p">):</span>
				<span class="n">d</span><span class="o">=</span><span class="n">ta</span><span class="o">.</span><span class="n">_ohlc_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
				<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span><span class="o">!=</span><span class="mi">4</span><span class="p">:</span>
					<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;OHLC type of charts require an Open, High, Low and Close column&quot;</span><span class="p">)</span>				
				<span class="n">ohlc_kwargs</span><span class="o">=</span><span class="n">check_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">OHLC_KWARGS</span><span class="p">)</span>
				<span class="k">if</span> <span class="n">kind</span><span class="o">==</span><span class="s1">&#39;old_candle&#39;</span><span class="p">:</span>					
					<span class="n">fig</span><span class="o">=</span><span class="n">tools</span><span class="o">.</span><span class="n">get_candle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">theme</span><span class="o">=</span><span class="n">theme</span><span class="p">,</span><span class="n">layout</span><span class="o">=</span><span class="n">layout</span><span class="p">,</span><span class="o">**</span><span class="n">ohlc_kwargs</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">fig</span><span class="o">=</span><span class="n">tools</span><span class="o">.</span><span class="n">get_ohlc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">theme</span><span class="o">=</span><span class="n">theme</span><span class="p">,</span><span class="n">layout</span><span class="o">=</span><span class="n">layout</span><span class="p">,</span><span class="o">**</span><span class="n">ohlc_kwargs</span><span class="p">)</span>
				<span class="k">if</span> <span class="n">bestfit</span><span class="p">:</span>
					<span class="n">df</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
					<span class="n">bf</span><span class="o">=</span><span class="n">_to_iplot</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]],</span><span class="n">bestfit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">bestfit_colors</span><span class="o">=</span><span class="n">bestfit_colors</span><span class="p">,</span><span class="n">asTimestamp</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
					<span class="n">fig</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bf</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
				<span class="n">data</span><span class="o">=</span><span class="n">fig</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]</span>
				<span class="n">layout</span><span class="o">=</span><span class="n">fig</span><span class="p">[</span><span class="s1">&#39;layout&#39;</span><span class="p">]</span>

			<span class="k">elif</span> <span class="n">kind</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;candle&#39;</span><span class="p">,</span><span class="s1">&#39;ohlc&#39;</span><span class="p">,</span><span class="s1">&#39;candlestick&#39;</span><span class="p">):</span>
				<span class="n">kind</span><span class="o">=</span><span class="s1">&#39;candlestick&#39;</span> <span class="k">if</span> <span class="n">kind</span><span class="o">==</span><span class="s1">&#39;candle&#39;</span> <span class="k">else</span> <span class="n">kind</span>
				<span class="n">kw</span><span class="o">=</span><span class="n">check_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">OHLC_KWARGS</span><span class="p">)</span>
				<span class="n">d</span><span class="o">=</span><span class="n">ta</span><span class="o">.</span><span class="n">_ohlc_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">validate</span><span class="o">=</span><span class="s1">&#39;ohlc&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">kw</span><span class="p">)</span>
				<span class="n">_d</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="n">kind</span><span class="p">,</span>
							<span class="nb">open</span><span class="o">=</span><span class="bp">self</span><span class="p">[</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;open&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
							<span class="n">high</span><span class="o">=</span><span class="bp">self</span><span class="p">[</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
							<span class="n">low</span><span class="o">=</span><span class="bp">self</span><span class="p">[</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;low&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
							<span class="n">close</span><span class="o">=</span><span class="bp">self</span><span class="p">[</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
							<span class="n">x</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span>
												<span class="p">)</span>
				<span class="k">if</span> <span class="s1">&#39;name&#39;</span> <span class="ow">in</span> <span class="n">kw</span><span class="p">:</span>
					<span class="n">_d</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">kw</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
				
				<span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span>
				<span class="k">if</span> <span class="s1">&#39;showlegend&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
					<span class="n">showlegend</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;showlegend&#39;</span><span class="p">]</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="k">if</span> <span class="s1">&#39;legend&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
						<span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend&#39;</span><span class="p">])</span><span class="o">==</span><span class="nb">bool</span><span class="p">:</span>
							<span class="n">showlegend</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend&#39;</span><span class="p">]</span>
				
				<span class="n">_d</span><span class="p">[</span><span class="s1">&#39;increasing&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">kw</span><span class="p">[</span><span class="s1">&#39;up_color&#39;</span><span class="p">])</span> <span class="k">if</span> <span class="s1">&#39;up_color&#39;</span> <span class="ow">in</span> <span class="n">kw</span> <span class="k">else</span> <span class="nb">dict</span><span class="p">(),</span><span class="n">showlegend</span><span class="o">=</span><span class="n">showlegend</span><span class="p">)</span>
				<span class="n">_d</span><span class="p">[</span><span class="s1">&#39;decreasing&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">kw</span><span class="p">[</span><span class="s1">&#39;down_color&#39;</span><span class="p">])</span> <span class="k">if</span> <span class="s1">&#39;down_color&#39;</span> <span class="ow">in</span> <span class="n">kw</span> <span class="k">else</span> <span class="nb">dict</span><span class="p">(),</span><span class="n">showlegend</span><span class="o">=</span><span class="n">showlegend</span><span class="p">)</span>
				<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;increasing&#39;</span><span class="p">,</span><span class="s1">&#39;decreasing&#39;</span><span class="p">):</span>
					<span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">kw</span><span class="p">:</span>
						<span class="n">_d</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="n">deep_update</span><span class="p">(</span><span class="n">_d</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">kw</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
				
				<span class="n">_d</span><span class="p">[</span><span class="s1">&#39;yaxis&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;y2&#39;</span>
				<span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="n">_d</span><span class="p">]</span>



			<span class="k">elif</span> <span class="n">kind</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;choropleth&#39;</span><span class="p">,</span><span class="s1">&#39;scattergeo&#39;</span><span class="p">):</span>
				<span class="n">kw</span><span class="o">=</span><span class="n">check_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">GEO_KWARGS</span><span class="p">)</span>
				<span class="k">if</span> <span class="n">kind</span><span class="o">==</span><span class="s1">&#39;choropleth&#39;</span><span class="p">:</span>
					<span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span><span class="n">x</span><span class="o">!=</span><span class="kc">None</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">(</span><span class="n">locations</span><span class="p">,</span><span class="n">z</span><span class="p">)]):</span>
						<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Choropleth maps require a &#39;location&#39; and &#39;z&#39; column names specified&quot;</span><span class="p">)</span>
					<span class="n">geo_data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span><span class="s1">&#39;choropleth&#39;</span><span class="p">,</span><span class="s1">&#39;locations&#39;</span><span class="p">:</span><span class="bp">self</span><span class="p">[</span><span class="n">locations</span><span class="p">],</span><span class="s1">&#39;z&#39;</span><span class="p">:</span><span class="bp">self</span><span class="p">[</span><span class="n">z</span><span class="p">],</span>
							<span class="s1">&#39;colorscale&#39;</span><span class="p">:</span><span class="n">get_colorscale</span><span class="p">(</span><span class="n">colorscale</span><span class="p">),</span>
							<span class="s1">&#39;marker&#39;</span><span class="p">:</span><span class="n">get_marker</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Marker</span><span class="p">(</span><span class="n">line</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Line</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">)))}</span>
				<span class="k">elif</span> <span class="n">kind</span><span class="o">==</span><span class="s1">&#39;scattergeo&#39;</span><span class="p">:</span>
					<span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span><span class="n">x</span><span class="o">!=</span><span class="kc">None</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">(</span><span class="n">lon</span><span class="p">,</span><span class="n">lat</span><span class="p">)]):</span>
						<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Scattergeo maps require a &#39;lon&#39; and &#39;lat&#39; column names specified&quot;</span><span class="p">)</span>
					<span class="n">geo_data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span><span class="s1">&#39;scattergeo&#39;</span><span class="p">,</span><span class="s1">&#39;lat&#39;</span><span class="p">:</span><span class="bp">self</span><span class="p">[</span><span class="n">lat</span><span class="p">],</span><span class="s1">&#39;lon&#39;</span><span class="p">:</span><span class="bp">self</span><span class="p">[</span><span class="n">lon</span><span class="p">],</span>
							<span class="s1">&#39;marker&#39;</span><span class="p">:</span><span class="n">get_marker</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Marker</span><span class="p">(</span><span class="n">line</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Line</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">),</span>
												<span class="n">symbol</span><span class="o">=</span><span class="n">symbol</span><span class="p">,</span><span class="n">colorscale</span><span class="o">=</span><span class="n">get_colorscale</span><span class="p">(</span><span class="n">colorscale</span><span class="p">),</span>
												<span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="p">[</span><span class="n">z</span><span class="p">]</span> <span class="k">if</span> <span class="n">z</span> <span class="k">else</span> <span class="kc">None</span><span class="p">))}</span>
				<span class="k">if</span> <span class="s1">&#39;colorbar&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
					<span class="n">geo_data</span><span class="p">[</span><span class="s1">&#39;colorbar&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;colorbar&#39;</span><span class="p">]</span>
				<span class="n">geo_data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kw</span><span class="p">)</span>
				<span class="k">if</span> <span class="n">text</span><span class="p">:</span>
					<span class="n">geo_data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="bp">self</span><span class="p">[</span><span class="n">text</span><span class="p">])</span>
				<span class="n">validate</span><span class="o">=</span><span class="kc">False</span>
				<span class="n">data</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Data</span><span class="p">()</span>
				<span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">geo_data</span><span class="p">)</span>
	
<span class="c1">## Sharing Values</span>
	<span class="k">if</span> <span class="nb">all</span><span class="p">([</span><span class="s1">&#39;world_readable&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">,</span><span class="n">sharing</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">]):</span>
		<span class="n">sharing</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;world_readable&#39;</span><span class="p">]</span>
	<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sharing</span><span class="p">,</span><span class="nb">bool</span><span class="p">):</span>
			<span class="k">if</span> <span class="n">sharing</span><span class="p">:</span>
				<span class="n">sharing</span><span class="o">=</span><span class="s1">&#39;public&#39;</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">sharing</span><span class="o">=</span><span class="s1">&#39;private&#39;</span>
	<span class="k">if</span> <span class="n">sharing</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
		<span class="n">sharing</span><span class="o">=</span><span class="n">auth</span><span class="o">.</span><span class="n">get_config_file</span><span class="p">()[</span><span class="s1">&#39;sharing&#39;</span><span class="p">]</span>

	<span class="k">if</span> <span class="ow">not</span> <span class="n">filename</span><span class="p">:</span>
		<span class="k">if</span> <span class="n">title</span><span class="p">:</span>
			<span class="n">filename</span><span class="o">=</span><span class="n">title</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">filename</span><span class="o">=</span><span class="s1">&#39;Plotly Playground </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span><span class="p">))</span>

	

<span class="c1">## Figure defintion</span>
	<span class="n">figure</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
	<span class="n">figure</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">data</span>
	<span class="n">figure</span><span class="p">[</span><span class="s1">&#39;layout&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">layout</span>

<span class="c1">## Check secondary axis</span>
	<span class="k">if</span> <span class="n">secondary_y</span><span class="p">:</span>
		<span class="n">figure</span><span class="o">=</span><span class="n">figure</span><span class="o">.</span><span class="n">set_axis</span><span class="p">(</span><span class="n">secondary_y</span><span class="p">,</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">secondary_y_title</span><span class="p">:</span>
			<span class="n">figure</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">yaxis2</span><span class="o">.</span><span class="n">title</span><span class="o">=</span><span class="n">secondary_y_title</span>

<span class="c1">## Error Bars</span>
	<span class="k">if</span> <span class="n">kind</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;scatter&#39;</span><span class="p">,</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span><span class="s1">&#39;barh&#39;</span><span class="p">,</span><span class="s1">&#39;lines&#39;</span><span class="p">):</span>
		<span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">error_x</span><span class="p">,</span><span class="n">error_y</span><span class="p">]):</span>
			<span class="k">def</span> <span class="nf">set_error</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
				<span class="k">return</span> <span class="n">tools</span><span class="o">.</span><span class="n">set_errors</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
			<span class="n">kw</span><span class="o">=</span><span class="n">check_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">ERROR_KWARGS</span><span class="p">)</span>
			<span class="n">kw</span><span class="o">=</span><span class="nb">dict</span><span class="p">([(</span><span class="n">k</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;error_&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">),</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kw</span><span class="o">.</span><span class="n">items</span><span class="p">())])</span>
			<span class="n">kw</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">error_type</span>
			<span class="k">if</span> <span class="n">error_x</span><span class="p">:</span>
				<span class="n">kw</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">error_x</span>
				<span class="n">figure</span><span class="o">=</span><span class="n">set_error</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">kw</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">error_y</span><span class="p">:</span>
				<span class="n">kw</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">error_y</span>
				<span class="n">figure</span><span class="o">=</span><span class="n">set_error</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">kw</span><span class="p">)</span>
<span class="c1">## Subplots </span>

	<span class="k">if</span> <span class="n">subplots</span><span class="p">:</span>
		<span class="n">fig</span><span class="o">=</span><span class="n">tools</span><span class="o">.</span><span class="n">strip_figures</span><span class="p">(</span><span class="n">figure</span><span class="p">)</span>
		<span class="n">kw</span><span class="o">=</span><span class="n">check_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">SUBPLOT_KWARGS</span><span class="p">)</span>	
		<span class="k">if</span> <span class="s1">&#39;subplot_titles&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;subplot_titles&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">True</span><span class="p">:</span>
				<span class="n">kw</span><span class="p">[</span><span class="s1">&#39;subplot_titles&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">kw</span><span class="p">[</span><span class="s1">&#39;subplot_titles&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;subplot_titles&#39;</span><span class="p">]</span>		
		<span class="n">figure</span><span class="o">=</span><span class="n">tools</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">shape</span><span class="p">,</span><span class="n">base_layout</span><span class="o">=</span><span class="n">layout</span><span class="p">,</span><span class="n">theme</span><span class="o">=</span><span class="n">theme</span><span class="p">,</span><span class="o">**</span><span class="n">kw</span><span class="p">)</span>


<span class="c1">## Exports </span>
	<span class="n">validate</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="s1">&#39;shapes&#39;</span> <span class="ow">in</span> <span class="n">layout</span> <span class="k">else</span> <span class="n">validate</span>

	<span class="k">if</span> <span class="n">asFigure</span><span class="p">:</span>
		<span class="k">return</span> <span class="n">figure</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="k">return</span> <span class="n">iplot</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span><span class="n">validate</span><span class="o">=</span><span class="n">validate</span><span class="p">,</span><span class="n">sharing</span><span class="o">=</span><span class="n">sharing</span><span class="p">,</span><span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
			 <span class="n">online</span><span class="o">=</span><span class="n">online</span><span class="p">,</span><span class="n">asImage</span><span class="o">=</span><span class="n">asImage</span><span class="p">,</span><span class="n">asUrl</span><span class="o">=</span><span class="n">asUrl</span><span class="p">,</span><span class="n">asPlot</span><span class="o">=</span><span class="n">asPlot</span><span class="p">,</span>
			 <span class="n">dimensions</span><span class="o">=</span><span class="n">dimensions</span><span class="p">,</span><span class="n">display_image</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;display_image&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">))</span>
	

<div class="viewcode-block" id="get_colors"><a class="viewcode-back" href="../../cufflinks.plotlytools.html#cufflinks.plotlytools.get_colors">[docs]</a><span class="k">def</span> <span class="nf">get_colors</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span><span class="n">colorscale</span><span class="p">,</span><span class="n">keys</span><span class="p">,</span><span class="n">asList</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
	<span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span><span class="o">!=</span><span class="nb">dict</span><span class="p">:</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">colors</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">colorscale</span><span class="p">:</span>
					<span class="n">colors</span><span class="o">=</span><span class="n">get_scales</span><span class="p">(</span><span class="n">colorscale</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">keys</span><span class="p">))</span>
			<span class="n">clrgen</span><span class="o">=</span><span class="n">colorgen</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">keys</span><span class="p">))</span>
			<span class="k">if</span> <span class="n">asList</span><span class="p">:</span>
				<span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="nb">next</span><span class="p">(</span><span class="n">clrgen</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">]</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">colors</span><span class="o">=</span><span class="p">{}</span>
				<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
					<span class="n">colors</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">=</span><span class="nb">next</span><span class="p">(</span><span class="n">clrgen</span><span class="p">)</span>
	<span class="k">return</span> <span class="n">colors</span></div>

<div class="viewcode-block" id="get_items_as_list"><a class="viewcode-back" href="../../cufflinks.plotlytools.html#cufflinks.plotlytools.get_items_as_list">[docs]</a><span class="k">def</span> <span class="nf">get_items_as_list</span><span class="p">(</span><span class="n">items</span><span class="p">,</span><span class="n">keys</span><span class="p">,</span><span class="n">items_names</span><span class="o">=</span><span class="s1">&#39;styles&#39;</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Returns a dict with an item per key</span>

<span class="sd">	Parameters:</span>
<span class="sd">	-----------</span>
<span class="sd">		items : string, list or dict</span>
<span class="sd">			Items (ie line styles)</span>
<span class="sd">		keys: list </span>
<span class="sd">			List of keys</span>
<span class="sd">		items_names : string</span>
<span class="sd">			Name of items </span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">items</span><span class="p">)</span><span class="o">!=</span><span class="nb">dict</span><span class="p">:</span>
		<span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">items</span><span class="p">)</span><span class="o">==</span><span class="nb">list</span><span class="p">:</span>
			<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span><span class="o">!=</span><span class="nb">len</span><span class="p">(</span><span class="n">keys</span><span class="p">):</span>
				<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;List of </span><span class="si">{0}</span><span class="s1"> is not the same length as keys&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">items_names</span><span class="p">))</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">items</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span><span class="n">items</span><span class="p">))</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">items</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">keys</span><span class="p">,[</span><span class="n">items</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">keys</span><span class="p">)))</span>
	<span class="k">return</span> <span class="n">items</span></div>


<span class="k">def</span> <span class="nf">_scatter_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">theme</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">asFigure</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">iplot_kwargs</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Displays a matrix with scatter plot for each pair of </span>
<span class="sd">	Series in the DataFrame.</span>
<span class="sd">	The diagonal shows a histogram for each of the Series</span>

<span class="sd">	Parameters:</span>
<span class="sd">	-----------</span>
<span class="sd">		df : DataFrame</span>
<span class="sd">			Pandas DataFrame</span>
<span class="sd">		theme : string</span>
<span class="sd">			Theme to be used (if not the default)</span>
<span class="sd">		bins : int</span>
<span class="sd">			Number of bins to use for histogram</span>
<span class="sd">		color : string</span>
<span class="sd">			Color to be used for each scatter plot</span>
<span class="sd">		size : int</span>
<span class="sd">			Size for each marker on the scatter plot</span>
<span class="sd">		iplot_kwargs : key-value pairs</span>
<span class="sd">			Keyword arguments to pass through to `iplot`</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="n">sm</span><span class="o">=</span><span class="n">tools</span><span class="o">.</span><span class="n">scatter_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">theme</span><span class="o">=</span><span class="n">theme</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
	<span class="k">if</span> <span class="n">asFigure</span><span class="p">:</span>
		<span class="k">return</span> <span class="n">sm</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="k">return</span> <span class="n">iplot</span><span class="p">(</span><span class="n">sm</span><span class="p">,</span><span class="o">**</span><span class="n">iplot_kwargs</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">_figure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Generates a Plotly figure for the given DataFrame</span>

<span class="sd">	Parameters:</span>
<span class="sd">	-----------</span>
<span class="sd">			All properties avaialbe can be seen with</span>
<span class="sd">			help(cufflinks.pd.DataFrame.iplot)</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;asFigure&#39;</span><span class="p">]</span><span class="o">=</span><span class="kc">True</span>
	<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">iplot</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">_layout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Generates a Plotly layout for the given DataFrame</span>

<span class="sd">	Parameters:</span>
<span class="sd">	-----------</span>
<span class="sd">			All properties avaialbe can be seen with</span>
<span class="sd">			help(cufflinks.pd.DataFrame.iplot)</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;asFigure&#39;</span><span class="p">]</span><span class="o">=</span><span class="kc">True</span>
	<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">iplot</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)[</span><span class="s1">&#39;layout&#39;</span><span class="p">]</span>

	
<span class="c1"># ONLINE</span>
<span class="c1"># py.iplot(filename,fileopt,sharing,world_readable)</span>
<span class="c1"># py.plot(filename,fileopt,auto_open,sharing,world_readable)</span>
<span class="c1"># py.image.ishow(figure,format,width,height,scale)</span>
<span class="c1"># py.image.save_as(figure,filename,format,width,height,scale)</span>

<span class="c1"># OFFLINE</span>
<span class="c1"># py_offline.iplot(figure,show_link,link_text,validate,image,filename,image_width,image_height,config)</span>
<span class="c1"># py_offline.plot(figure,show_link,link_text,validate,output_type,include_plotlyjs,filename,auto_open,image,image_filename,image_width,image_height,config)</span>


<div class="viewcode-block" id="iplot"><a class="viewcode-back" href="../../cufflinks.plotlytools.html#cufflinks.plotlytools.iplot">[docs]</a><span class="k">def</span> <span class="nf">iplot</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span><span class="n">validate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">sharing</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
			 <span class="n">online</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">asImage</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">asUrl</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">asPlot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
			 <span class="n">dimensions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">display_image</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Plots a figure in IPython, creates an HTML or generates an Image</span>

<span class="sd">	figure : figure</span>
<span class="sd">		Plotly figure to be charted</span>
<span class="sd">	validate : bool</span>
<span class="sd">		If True then all values are validated before </span>
<span class="sd">		it is charted</span>
<span class="sd">	sharing : string</span>
<span class="sd">		Sets the sharing level permission</span>
<span class="sd">			public - anyone can see this chart</span>
<span class="sd">			private - only you can see this chart</span>
<span class="sd">			secret - only people with the link can see the chart</span>
<span class="sd">	filename : string</span>
<span class="sd">		Name to be used to save the file in the server, or as an image</span>
<span class="sd">	online : bool</span>
<span class="sd">		If True then the chart/image is rendered on the server </span>
<span class="sd">		even when running in offline mode. </span>
<span class="sd">	asImage : bool</span>
<span class="sd">			If True it returns an Image (png)</span>
<span class="sd">			In ONLINE mode:</span>
<span class="sd">				Image file is saved in the working directory				</span>
<span class="sd">					Accepts:</span>
<span class="sd">						filename</span>
<span class="sd">						dimensions</span>
<span class="sd">						scale</span>
<span class="sd">						display_image</span>
<span class="sd">			In OFFLINE mode:</span>
<span class="sd">				Image file is downloaded (downloads folder) and a </span>
<span class="sd">				regular plotly chart is displayed in Jupyter</span>
<span class="sd">					Accepts:</span>
<span class="sd">						filename</span>
<span class="sd">						dimensions</span>
<span class="sd">	asUrl : bool</span>
<span class="sd">		If True the chart url/path is returned. No chart is displayed. </span>
<span class="sd">			If Online : the URL is returned</span>
<span class="sd">			If Offline : the local path is returned</span>
<span class="sd">	asPlot : bool</span>
<span class="sd">		If True the chart opens in browser</span>
<span class="sd">	dimensions : tuple(int,int)</span>
<span class="sd">		Dimensions for image</span>
<span class="sd">			(width,height)		</span>
<span class="sd">	display_image : bool</span>
<span class="sd">		If true, then the image is displayed after it has been saved</span>
<span class="sd">		Requires Jupyter Notebook</span>
<span class="sd">		Only valid when asImage=True</span>

<span class="sd">	Other Kwargs</span>
<span class="sd">	============</span>
<span class="sd">		legend : bool</span>
<span class="sd">			If False then the legend will not be shown</span>
<span class="sd">		scale : integer</span>
<span class="sd">			Increase the resolution of the image by `scale` amount</span>
<span class="sd">			Only valid when asImage=True		</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="n">valid_kwargs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;world_readable&#39;</span><span class="p">,</span><span class="s1">&#39;legend&#39;</span><span class="p">,</span><span class="s1">&#39;scale&#39;</span><span class="p">]</span>

	<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
		<span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">valid_kwargs</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Invalid keyword : &#39;</span><span class="si">{0}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
	
	<span class="k">if</span> <span class="s1">&#39;legend&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
		<span class="k">if</span> <span class="s1">&#39;layout&#39;</span> <span class="ow">in</span> <span class="n">figure</span><span class="p">:</span>
			<span class="n">figure</span><span class="p">[</span><span class="s1">&#39;layout&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">showlegend</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;legend&#39;</span><span class="p">])</span>

	<span class="c1">## Sharing Values</span>
	<span class="k">if</span> <span class="nb">all</span><span class="p">([</span><span class="s1">&#39;world_readable&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">,</span><span class="n">sharing</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">]):</span>
		<span class="n">sharing</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;world_readable&#39;</span><span class="p">]</span>
	<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sharing</span><span class="p">,</span><span class="nb">bool</span><span class="p">):</span>
			<span class="k">if</span> <span class="n">sharing</span><span class="p">:</span>
				<span class="n">sharing</span><span class="o">=</span><span class="s1">&#39;public&#39;</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">sharing</span><span class="o">=</span><span class="s1">&#39;private&#39;</span>
	<span class="k">if</span> <span class="n">sharing</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
		<span class="n">sharing</span><span class="o">=</span><span class="n">auth</span><span class="o">.</span><span class="n">get_config_file</span><span class="p">()[</span><span class="s1">&#39;sharing&#39;</span><span class="p">]</span>

	<span class="c1">## Filename Handling</span>
	<span class="k">if</span> <span class="ow">not</span> <span class="n">filename</span><span class="p">:</span>
		<span class="k">if</span> <span class="n">figure</span><span class="p">[</span><span class="s1">&#39;layout&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">]:</span>
			<span class="n">filename</span><span class="o">=</span><span class="n">figure</span><span class="p">[</span><span class="s1">&#39;layout&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">]</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">filename</span><span class="o">=</span><span class="s1">&#39;Plotly Playground </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span><span class="p">))</span>

	<span class="c1">## Dimensions</span>
	<span class="k">if</span> <span class="ow">not</span> <span class="n">dimensions</span><span class="p">:</span>
		<span class="n">dimensions</span><span class="o">=</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span><span class="mi">500</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">auth</span><span class="o">.</span><span class="n">get_config_file</span><span class="p">()[</span><span class="s1">&#39;dimensions&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="n">auth</span><span class="o">.</span><span class="n">get_config_file</span><span class="p">()[</span><span class="s1">&#39;dimensions&#39;</span><span class="p">]</span>

	<span class="c1">## Offline Links</span>
	<span class="n">show_link</span> <span class="o">=</span> <span class="n">auth</span><span class="o">.</span><span class="n">get_config_file</span><span class="p">()[</span><span class="s1">&#39;offline_show_link&#39;</span><span class="p">]</span>
	<span class="n">link_text</span> <span class="o">=</span> <span class="n">auth</span><span class="o">.</span><span class="n">get_config_file</span><span class="p">()[</span><span class="s1">&#39;offline_link_text&#39;</span><span class="p">]</span>

	<span class="c1">## Remove validation if shapes are present</span>
	<span class="k">if</span> <span class="s1">&#39;layout&#39;</span> <span class="ow">in</span> <span class="n">figure</span><span class="p">:</span>
		<span class="n">validate</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="s1">&#39;shapes&#39;</span> <span class="ow">in</span> <span class="n">figure</span><span class="p">[</span><span class="s1">&#39;layout&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="n">validate</span>

	<span class="c1">## asURL</span>
	<span class="n">auto_open</span><span class="o">=</span><span class="kc">True</span>
	<span class="k">if</span> <span class="n">asUrl</span><span class="p">:</span>
		<span class="n">asPlot</span><span class="o">=</span><span class="kc">True</span>
		<span class="n">auto_open</span><span class="o">=</span><span class="kc">False</span>

	<span class="c1">## Exports</span>
	<span class="k">if</span> <span class="n">asImage</span><span class="p">:</span>
		<span class="k">if</span> <span class="n">offline</span><span class="o">.</span><span class="n">is_offline</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">online</span><span class="p">:</span>
			<span class="k">return</span> <span class="n">offline</span><span class="o">.</span><span class="n">py_offline</span><span class="o">.</span><span class="n">iplot</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span><span class="n">validate</span><span class="o">=</span><span class="n">validate</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">show_link</span><span class="o">=</span><span class="n">show_link</span><span class="p">,</span><span class="n">link_text</span><span class="o">=</span><span class="n">link_text</span><span class="p">,</span>
				<span class="n">image</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span><span class="n">image_width</span><span class="o">=</span><span class="n">dimensions</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">image_height</span><span class="o">=</span><span class="n">dimensions</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">try</span><span class="p">:</span>
				<span class="n">py</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">save_as</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;img/&#39;</span><span class="o">+</span><span class="n">filename</span><span class="p">,</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span>
					<span class="n">width</span><span class="o">=</span><span class="n">dimensions</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">height</span><span class="o">=</span><span class="n">dimensions</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">scale</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;scale&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">))</span>
				<span class="n">path</span><span class="o">=</span><span class="s1">&#39;img/&#39;</span><span class="o">+</span><span class="n">filename</span><span class="o">+</span><span class="s1">&#39;.png&#39;</span>
			<span class="k">except</span><span class="p">:</span>
				<span class="n">py</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">save_as</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span><span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span>
					<span class="n">width</span><span class="o">=</span><span class="n">dimensions</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">height</span><span class="o">=</span><span class="n">dimensions</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">scale</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;scale&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">))</span>
				<span class="n">path</span><span class="o">=</span><span class="n">filename</span><span class="o">+</span><span class="s1">&#39;.png&#39;</span>
			<span class="k">if</span> <span class="n">display_image</span><span class="p">:</span>
				<span class="k">return</span> <span class="n">display</span><span class="p">(</span><span class="n">Image</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Image saved : </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
				<span class="k">return</span> <span class="kc">None</span>

	<span class="c1">## asPlot and asUrl</span>
	<span class="k">if</span> <span class="n">asPlot</span><span class="p">:</span>
		<span class="n">filename</span><span class="o">+=</span><span class="s1">&#39;.html&#39;</span>
		<span class="k">if</span> <span class="n">offline</span><span class="o">.</span><span class="n">is_offline</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">online</span><span class="p">:</span>
			<span class="k">return</span> <span class="n">offline</span><span class="o">.</span><span class="n">py_offline</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="n">validate</span><span class="p">,</span>
								<span class="n">show_link</span><span class="o">=</span><span class="n">show_link</span><span class="p">,</span><span class="n">link_text</span><span class="o">=</span><span class="n">link_text</span><span class="p">,</span><span class="n">auto_open</span><span class="o">=</span><span class="n">auto_open</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">return</span> <span class="n">py</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span> <span class="n">sharing</span><span class="o">=</span><span class="n">sharing</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="n">validate</span><span class="p">,</span>
							<span class="n">auto_open</span><span class="o">=</span><span class="n">auto_open</span><span class="p">)</span>

	<span class="c1">## iplot</span>
	<span class="k">if</span> <span class="n">offline</span><span class="o">.</span><span class="n">is_offline</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">online</span><span class="p">:</span>	
		<span class="k">return</span> <span class="n">offline</span><span class="o">.</span><span class="n">py_offline</span><span class="o">.</span><span class="n">iplot</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span><span class="n">validate</span><span class="o">=</span><span class="n">validate</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">show_link</span><span class="o">=</span><span class="n">show_link</span><span class="p">,</span><span class="n">link_text</span><span class="o">=</span><span class="n">link_text</span><span class="p">)</span>
	<span class="k">else</span><span class="p">:</span>		
		<span class="k">return</span> <span class="n">py</span><span class="o">.</span><span class="n">iplot</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span><span class="n">validate</span><span class="o">=</span><span class="n">validate</span><span class="p">,</span><span class="n">sharing</span><span class="o">=</span><span class="n">sharing</span><span class="p">,</span>
						<span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">)</span></div>

		

<span class="k">def</span> <span class="nf">_ta_figure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Generates a Plotly figure for the given DataFrame</span>

<span class="sd">	Parameters:</span>
<span class="sd">	-----------</span>
<span class="sd">			All properties avaialbe can be seen with</span>
<span class="sd">			help(cufflinks.pd.DataFrame.iplot)</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;asFigure&#39;</span><span class="p">]</span><span class="o">=</span><span class="kc">True</span>
	<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ta_plot</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_ta_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">study</span><span class="p">,</span><span class="n">periods</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">include</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="nb">str</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{name}</span><span class="s1">(</span><span class="si">{period}</span><span class="s1">)&#39;</span><span class="p">,</span><span class="n">detail</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
			 <span class="n">theme</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">sharing</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">asFigure</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="o">**</span><span class="n">iplot_kwargs</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Generates a Technical Study Chart</span>

<span class="sd">	Parameters:</span>
<span class="sd">	-----------</span>
<span class="sd">			study : string</span>
<span class="sd">				Technical Study to be charted</span>
<span class="sd">					sma - &#39;Simple Moving Average&#39;</span>
<span class="sd">					rsi - &#39;R Strength Indicator&#39;</span>
<span class="sd">			periods : int</span>
<span class="sd">				Number of periods</span>
<span class="sd">			column : string</span>
<span class="sd">				Name of the column on which the</span>
<span class="sd">				study will be done</span>
<span class="sd">			include : bool</span>
<span class="sd">				Indicates if the input column(s)</span>
<span class="sd">				should be included in the chart</span>
<span class="sd">			str : string</span>
<span class="sd">				Label factory for studies</span>
<span class="sd">				The following wildcards can be used:</span>
<span class="sd">					{name} : Name of the column</span>
<span class="sd">					{study} : Name of the study</span>
<span class="sd">					{period} : Period used</span>
<span class="sd">				Examples:</span>
<span class="sd">					&#39;study: {study} - period: {period}&#39;</span>
<span class="sd">			detail : bool</span>
<span class="sd">				If True the supporting data/calculations</span>
<span class="sd">				are included in the chart </span>
<span class="sd">			study_colors : string or [string]</span>
<span class="sd">				Colors to be used for the studies</span>

<span class="sd">		Study Specific Parameters</span>
<span class="sd">		-------------------------</span>
<span class="sd">		RSI </span>
<span class="sd">			rsi_upper : int (0,100]</span>
<span class="sd">				Level for the upper rsi band</span>
<span class="sd">				default : 70</span>
<span class="sd">			rsi_lower : int (0,100]</span>
<span class="sd">				Level for the lower rsi band</span>
<span class="sd">				default : 30</span>
<span class="sd">		CCI </span>
<span class="sd">			cci_upper : int </span>
<span class="sd">				Level for the upper cci band</span>
<span class="sd">				default : 100</span>
<span class="sd">			cci_lower : int </span>
<span class="sd">				Level for the lower cci band</span>
<span class="sd">				default : -100</span>
<span class="sd">		BOLL</span>
<span class="sd">			boll_std : int or float</span>
<span class="sd">				Number of standard deviations</span>
<span class="sd">		MACD</span>
<span class="sd">			fast_period : int</span>
<span class="sd">				Number of periods for the fast moving average</span>
<span class="sd">			slow_period : int</span>
<span class="sd">				Number of periods for the slow moving average</span>
<span class="sd">			signal_period : int</span>
<span class="sd">				Number of periods for the signal </span>
<span class="sd">		CORREL</span>
<span class="sd">			how : string</span>
<span class="sd">				Method for the correlation calculation</span>
<span class="sd">					values</span>
<span class="sd">					pct_cht</span>
<span class="sd">					diff</span>
<span class="sd">					</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="k">if</span> <span class="s1">&#39;columns&#39;</span> <span class="ow">in</span> <span class="n">iplot_kwargs</span><span class="p">:</span>
		<span class="n">column</span><span class="o">=</span><span class="n">iplot_kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
		
	<span class="k">if</span> <span class="s1">&#39;period&#39;</span> <span class="ow">in</span> <span class="n">iplot_kwargs</span><span class="p">:</span>
		<span class="n">periods</span><span class="o">=</span><span class="n">iplot_kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;period&#39;</span><span class="p">)</span>
		
	<span class="k">if</span> <span class="s1">&#39;world_readable&#39;</span> <span class="ow">in</span> <span class="n">iplot_kwargs</span><span class="p">:</span>
		<span class="n">sharing</span><span class="o">=</span><span class="n">iplot_kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;world_readable&#39;</span><span class="p">)</span>

	<span class="k">if</span> <span class="s1">&#39;study_color&#39;</span> <span class="ow">in</span> <span class="n">iplot_kwargs</span><span class="p">:</span>
		<span class="n">iplot_kwargs</span><span class="p">[</span><span class="s1">&#39;study_colors&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">iplot_kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;study_color&#39;</span><span class="p">)</span>
		
	<span class="k">if</span> <span class="n">sharing</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
			<span class="n">sharing</span> <span class="o">=</span> <span class="n">auth</span><span class="o">.</span><span class="n">get_config_file</span><span class="p">()[</span><span class="s1">&#39;sharing&#39;</span><span class="p">]</span>
	<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sharing</span><span class="p">,</span><span class="nb">bool</span><span class="p">):</span>
			<span class="k">if</span> <span class="n">sharing</span><span class="p">:</span>
				<span class="n">sharing</span><span class="o">=</span><span class="s1">&#39;public&#39;</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">sharing</span><span class="o">=</span><span class="s1">&#39;private&#39;</span>
	<span class="n">iplot_kwargs</span><span class="p">[</span><span class="s1">&#39;sharing&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">sharing</span>
	<span class="k">if</span> <span class="n">theme</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
		<span class="n">theme</span> <span class="o">=</span> <span class="n">iplot_kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;study_theme&#39;</span><span class="p">,</span><span class="n">auth</span><span class="o">.</span><span class="n">get_config_file</span><span class="p">()[</span><span class="s1">&#39;theme&#39;</span><span class="p">])</span>

	<span class="k">if</span> <span class="ow">not</span> <span class="n">filename</span><span class="p">:</span>
		<span class="k">if</span> <span class="s1">&#39;title&#39;</span> <span class="ow">in</span> <span class="n">iplot_kwargs</span><span class="p">:</span>
			<span class="n">filename</span><span class="o">=</span><span class="n">iplot_kwargs</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">filename</span><span class="o">=</span><span class="s1">&#39;Plotly Playground </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span><span class="p">))</span>

	<span class="k">def</span> <span class="nf">get_subplots</span><span class="p">(</span><span class="n">figures</span><span class="p">):</span>
		<span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">figures</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
		<span class="n">layout</span><span class="o">=</span><span class="n">tools</span><span class="o">.</span><span class="n">get_base_layout</span><span class="p">(</span><span class="n">figures</span><span class="p">)</span>
		<span class="n">subplots</span><span class="o">=</span><span class="n">tools</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figures</span><span class="p">,</span><span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span><span class="n">shared_xaxes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">base_layout</span><span class="o">=</span><span class="n">layout</span><span class="p">)</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">figures</span><span class="p">)</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
			<span class="n">subplots</span><span class="p">[</span><span class="s1">&#39;layout&#39;</span><span class="p">][</span><span class="s1">&#39;yaxis1&#39;</span><span class="p">][</span><span class="s1">&#39;domain&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="o">.</span><span class="mi">27</span><span class="p">,</span><span class="mf">1.0</span><span class="p">]</span>
			<span class="n">subplots</span><span class="p">[</span><span class="s1">&#39;layout&#39;</span><span class="p">][</span><span class="s1">&#39;yaxis2&#39;</span><span class="p">][</span><span class="s1">&#39;domain&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">.</span><span class="mi">25</span><span class="p">]</span>
		<span class="k">return</span> <span class="n">subplots</span>

	<span class="k">def</span> <span class="nf">get_study</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="n">func</span><span class="p">,</span><span class="n">iplot_kwargs</span><span class="p">,</span><span class="n">iplot_study_kwargs</span><span class="p">,</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">include</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">inset</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
		<span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
		<span class="k">if</span> <span class="n">inset</span><span class="p">:</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">column</span><span class="p">:</span>
				<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
					<span class="n">column</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
					<span class="n">column</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
		<span class="k">if</span> <span class="s1">&#39;legend&#39;</span> <span class="ow">in</span> <span class="n">iplot_kwargs</span><span class="p">:</span>
			<span class="n">iplot_study_kwargs</span><span class="p">[</span><span class="s1">&#39;legend&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">iplot_kwargs</span><span class="p">[</span><span class="s1">&#39;legend&#39;</span><span class="p">]</span>
		<span class="n">fig_0</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="o">**</span><span class="n">iplot_kwargs</span><span class="p">)</span>
		<span class="n">df_ta</span><span class="o">=</span><span class="n">func</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="n">column</span><span class="p">,</span><span class="n">include</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="nb">str</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span><span class="o">**</span><span class="n">study_kwargs</span><span class="p">)</span>	
		<span class="n">kind</span><span class="o">=</span><span class="n">iplot_kwargs</span><span class="p">[</span><span class="s1">&#39;kind&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;kind&#39;</span> <span class="ow">in</span> <span class="n">iplot_kwargs</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
		<span class="n">iplot_study_kwargs</span><span class="p">[</span><span class="s1">&#39;kind&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;scatter&#39;</span>
		<span class="n">iplot_study_kwargs</span><span class="p">[</span><span class="s1">&#39;colors&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">iplot_study_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;colors&#39;</span><span class="p">,[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="s1">&#39;green&#39;</span><span class="p">,</span><span class="s1">&#39;red&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="n">study</span><span class="o">==</span><span class="s1">&#39;dmi&#39;</span> <span class="k">else</span> <span class="s1">&#39;blue&#39;</span><span class="p">)</span>
		<span class="n">fig_1</span><span class="o">=</span><span class="n">df_ta</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">theme</span><span class="o">=</span><span class="n">theme</span><span class="p">,</span><span class="o">**</span><span class="n">iplot_study_kwargs</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">kind</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;candle&#39;</span><span class="p">,</span><span class="s1">&#39;ohlc&#39;</span><span class="p">]:</span>
				<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">fig_1</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]:</span>
					<span class="n">i</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">i</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]]</span>
		<span class="k">if</span> <span class="n">inset</span><span class="p">:</span>
			<span class="n">figure</span><span class="o">=</span><span class="n">tools</span><span class="o">.</span><span class="n">merge_figures</span><span class="p">([</span><span class="n">fig_0</span><span class="p">,</span><span class="n">fig_1</span><span class="p">])</span> <span class="k">if</span> <span class="n">include</span> <span class="k">else</span> <span class="n">fig_1</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">figure</span><span class="o">=</span><span class="n">get_subplots</span><span class="p">([</span><span class="n">fig_0</span><span class="p">,</span><span class="n">fig_1</span><span class="p">])</span> <span class="k">if</span> <span class="n">include</span> <span class="k">else</span> <span class="n">fig_1</span>
		<span class="k">return</span> <span class="n">figure</span>

	<span class="n">study_kwargs</span><span class="o">=</span><span class="p">{}</span>  
	<span class="n">iplot_study_kwargs</span><span class="o">=</span><span class="p">{}</span>

	<span class="n">study_kwargs</span><span class="o">=</span><span class="n">check_kwargs</span><span class="p">(</span><span class="n">iplot_kwargs</span><span class="p">,</span><span class="n">__TA_KWARGS</span><span class="p">,{},</span><span class="n">clean_origin</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
	<span class="n">iplot_study_kwargs</span><span class="o">=</span><span class="n">kwargs_from_keyword</span><span class="p">(</span><span class="n">iplot_kwargs</span><span class="p">,{},</span><span class="s1">&#39;study&#39;</span><span class="p">)</span>

	<span class="n">study_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;periods&#39;</span><span class="p">:</span><span class="n">periods</span><span class="p">})</span>

	<span class="n">ta_func</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="s1">&#39;ta.</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">study</span><span class="p">))</span>

	<span class="n">inset</span><span class="o">=</span><span class="n">study</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;sma&#39;</span><span class="p">,</span><span class="s1">&#39;boll&#39;</span><span class="p">,</span><span class="s1">&#39;ema&#39;</span><span class="p">,</span><span class="s1">&#39;atr&#39;</span><span class="p">,</span><span class="s1">&#39;ptps&#39;</span><span class="p">)</span>
	<span class="n">figure</span><span class="o">=</span><span class="n">get_study</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ta_func</span><span class="p">,</span><span class="n">iplot_kwargs</span><span class="p">,</span><span class="n">iplot_study_kwargs</span><span class="p">,</span><span class="n">include</span><span class="o">=</span><span class="n">include</span><span class="p">,</span>
					 <span class="n">column</span><span class="o">=</span><span class="n">column</span><span class="p">,</span><span class="nb">str</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span><span class="n">inset</span><span class="o">=</span><span class="n">inset</span><span class="p">)</span>

	<span class="c1">## Add Bands</span>
	<span class="k">if</span> <span class="n">study</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;rsi&#39;</span><span class="p">,</span><span class="s1">&#39;cci&#39;</span><span class="p">):</span>
		<span class="n">bands</span><span class="o">=</span> <span class="p">{</span><span class="s1">&#39;rsi&#39;</span><span class="p">:(</span><span class="mi">30</span><span class="p">,</span><span class="mi">70</span><span class="p">),</span>
				<span class="s1">&#39;cci&#39;</span><span class="p">:(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">)}</span>
		<span class="n">_upper</span><span class="o">=</span><span class="n">study_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">_upper&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">study</span><span class="p">),</span><span class="n">bands</span><span class="p">[</span><span class="n">study</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
		<span class="n">_lower</span><span class="o">=</span><span class="n">study_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">_lower&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">study</span><span class="p">),</span><span class="n">bands</span><span class="p">[</span><span class="n">study</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
		<span class="n">yref</span><span class="o">=</span><span class="s1">&#39;y2&#39;</span> <span class="k">if</span> <span class="n">include</span> <span class="k">else</span> <span class="s1">&#39;y1&#39;</span>
		<span class="n">shapes</span><span class="o">=</span><span class="p">[</span><span class="n">tools</span><span class="o">.</span><span class="n">get_shape</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">i</span><span class="p">,</span><span class="n">yref</span><span class="o">=</span><span class="n">yref</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">j</span><span class="p">,</span><span class="n">dash</span><span class="o">=</span><span class="s1">&#39;dash&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[(</span><span class="n">_lower</span><span class="p">,</span><span class="s1">&#39;green&#39;</span><span class="p">),(</span><span class="n">_upper</span><span class="p">,</span><span class="s1">&#39;red&#39;</span><span class="p">)]]</span>
		<span class="n">figure</span><span class="p">[</span><span class="s1">&#39;layout&#39;</span><span class="p">][</span><span class="s1">&#39;shapes&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">shapes</span>

	<span class="c1"># if study==&#39;rsi&#39;:</span>
	<span class="c1"># 	rsi_upper=study_kwargs.get(&#39;rsi_upper&#39;,70)</span>
	<span class="c1"># 	rsi_lower=study_kwargs.get(&#39;rsi_lower&#39;,30)</span>
	<span class="c1"># 	yref=&#39;y2&#39; if include else &#39;y1&#39;</span>
	<span class="c1"># 	shapes=[tools.get_shape(y=i,yref=yref,color=j,dash=&#39;dash&#39;) for (i,j) in [(rsi_lower,&#39;green&#39;),(rsi_upper,&#39;red&#39;)]]</span>
	<span class="c1"># 	figure[&#39;layout&#39;][&#39;shapes&#39;]=shapes</span>
	
	<span class="c1"># if study==&#39;cci&#39;:</span>
	<span class="c1"># 	cci_upper=study_kwargs.get(&#39;cci_upper&#39;,100)</span>
	<span class="c1"># 	cci_lower=study_kwargs.get(&#39;cci_lower&#39;,-100)</span>
	<span class="c1"># 	yref=&#39;y2&#39; if include else &#39;y1&#39;</span>
	<span class="c1"># 	shapes=[tools.get_shape(y=i,yref=yref,color=j,dash=&#39;dash&#39;) for (i,j) in [(cci_lower,&#39;green&#39;),(cci_upper,&#39;red&#39;)]]</span>
	<span class="c1"># 	figure[&#39;layout&#39;][&#39;shapes&#39;]=shapes</span>

	<span class="c1">## Exports</span>

	<span class="k">if</span> <span class="n">asFigure</span><span class="p">:</span>
		<span class="k">return</span> <span class="n">figure</span>
	<span class="k">else</span><span class="p">:</span> 
		<span class="k">return</span> <span class="n">iplot</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span><span class="n">sharing</span><span class="o">=</span><span class="n">sharing</span><span class="p">,</span><span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">_fig_iplot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">validate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">sharing</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
			 <span class="n">online</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">asImage</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">asUrl</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">asPlot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
			 <span class="n">dimensions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">display_image</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Plots a figure in IPython</span>

<span class="sd">	figure : figure</span>
<span class="sd">		Plotly figure to be charted</span>
<span class="sd">	validate : bool</span>
<span class="sd">		If True then all values are validated before </span>
<span class="sd">		it is charted</span>
<span class="sd">	sharing : string</span>
<span class="sd">		Sets the sharing level permission</span>
<span class="sd">			public - anyone can see this chart</span>
<span class="sd">			private - only you can see this chart</span>
<span class="sd">			secret - only people with the link can see the chart</span>
<span class="sd">	filename : string</span>
<span class="sd">		Name to be used to save the file in the server, or as an image</span>
<span class="sd">	online : bool</span>
<span class="sd">		If True then the chart is rendered on the server </span>
<span class="sd">		even when running in offline mode. </span>
<span class="sd">	asImage : bool</span>
<span class="sd">			If True it returns an Image (png)</span>
<span class="sd">			In ONLINE mode:</span>
<span class="sd">				Image file is saved in the working directory				</span>
<span class="sd">					Accepts:</span>
<span class="sd">						filename</span>
<span class="sd">						dimensions</span>
<span class="sd">						scale</span>
<span class="sd">						display_image</span>
<span class="sd">			In OFFLINE mode:</span>
<span class="sd">				Image file is downloaded (downloads folder) and a </span>
<span class="sd">				regular plotly chart is displayed in Jupyter</span>
<span class="sd">					Accepts:</span>
<span class="sd">						filename</span>
<span class="sd">						dimensions</span>
<span class="sd">	asUrl : bool</span>
<span class="sd">		If True the chart url/path is returned. No chart is displayed. </span>
<span class="sd">			If Online : the URL is returned</span>
<span class="sd">			If Offline : the local path is returned</span>
<span class="sd">	asPlot : bool</span>
<span class="sd">		If True the chart opens in browser</span>
<span class="sd">	dimensions : tuple(int,int)</span>
<span class="sd">		Dimensions for image</span>
<span class="sd">			(width,height)		</span>
<span class="sd">	display_image : bool</span>
<span class="sd">		If true, then the image is displayed after it has been saved</span>
<span class="sd">		Requires Jupyter Notebook</span>
<span class="sd">		onlh valide when asImage=True</span>

<span class="sd">	Other Kwargs</span>
<span class="sd">	============</span>

<span class="sd">		legend : bool</span>
<span class="sd">			If False then the legend will not be shown		</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="k">return</span> <span class="n">iplot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">validate</span><span class="o">=</span><span class="n">validate</span><span class="p">,</span><span class="n">sharing</span><span class="o">=</span><span class="n">sharing</span><span class="p">,</span><span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
			 <span class="n">online</span><span class="o">=</span><span class="n">online</span><span class="p">,</span><span class="n">asImage</span><span class="o">=</span><span class="n">asImage</span><span class="p">,</span><span class="n">asUrl</span><span class="o">=</span><span class="n">asUrl</span><span class="p">,</span><span class="n">asPlot</span><span class="o">=</span><span class="n">asPlot</span><span class="p">,</span>
			 <span class="n">dimensions</span><span class="o">=</span><span class="n">dimensions</span><span class="p">,</span><span class="n">display_image</span><span class="o">=</span><span class="n">display_image</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">to_iplot</span><span class="o">=</span><span class="n">_to_iplot</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">scatter_matrix</span><span class="o">=</span><span class="n">_scatter_matrix</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">figure</span><span class="o">=</span><span class="n">_figure</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">layout</span><span class="o">=</span><span class="n">_layout</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">ta_plot</span><span class="o">=</span><span class="n">_ta_plot</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">iplot</span><span class="o">=</span><span class="n">_iplot</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">ta_figure</span><span class="o">=</span><span class="n">_ta_figure</span>
<span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="o">.</span><span class="n">ta_figure</span><span class="o">=</span><span class="n">_ta_figure</span>
<span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="o">.</span><span class="n">ta_plot</span><span class="o">=</span><span class="n">_ta_plot</span>
<span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="o">.</span><span class="n">figure</span><span class="o">=</span><span class="n">_figure</span>
<span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="o">.</span><span class="n">to_iplot</span><span class="o">=</span><span class="n">_to_iplot</span>
<span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="o">.</span><span class="n">iplot</span><span class="o">=</span><span class="n">_iplot</span>
<span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="o">.</span><span class="n">iplot</span><span class="o">=</span><span class="n">_fig_iplot</span>


</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Jorge Santos.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
    </div>

    

    
  </body>
</html>